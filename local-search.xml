<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>è¿ç§»è¯­é›€æ–‡ç« å›¾ç‰‡è®¿é—®403</title>
    <link href="/2021/11/15/yuque-markdown/"/>
    <url>/2021/11/15/yuque-markdown/</url>
    
    <content type="html"><![CDATA[<blockquote><p>åŸæœ¬æƒ³æŠŠè¯­é›€ä¸Šçš„ä¸€éƒ¨åˆ†å†…å®¹è¿ç§»åˆ°è‡ªå·±çš„ Blog ä¸Šï¼Œè¯­é›€ä¹Ÿæä¾›äº†æŠŠæ–‡ç« è½¬ä¸º makrdown çš„åŠŸèƒ½ã€‚<br>è½¬å‡ºæ¥çš„æ–‡ç« çš„å›¾ç‰‡æ˜¯å­˜åœ¨è¯­é›€ cdn çš„é“¾æ¥ã€‚</p></blockquote><p>åç»­æ“ä½œè¿‡æ¥ï¼Œå‘ç°å›¾ç‰‡æ— æ³•æ˜¾ç¤ºï¼Œå›¾ç‰‡è¯·æ±‚æŠ¥ 403 é”™è¯¯ã€‚</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">Request URL: XXX<br>Request <span class="hljs-function"><span class="hljs-keyword">Method</span>:</span> GET<br>Status Code: <span class="hljs-number">403</span> <br>Remote Address: <span class="hljs-number">58.216</span>.<span class="hljs-number">16.42</span>:<span class="hljs-number">443</span><br>Referrer Policy: <span class="hljs-keyword">strict</span>-origin-when-cross-origin<br></code></pre></td></tr></table></figure><p>ä½†æœ¬åœ°ç›´æ¥è®¿é—® html æ–‡ä»¶çš„è¯ï¼Œå›¾ç‰‡é“¾æ¥æ˜¯å¯ä»¥ç›´æ¥è®¿é—®çš„ã€‚<br>å¯¹æ¯”äº†ä¸€ä¸‹ä¿©è¾¹çš„è¯·æ±‚å¤´ï¼Œå‘ç°å¯èƒ½æ˜¯ refrrer å‚æ•°å€¼çš„ç¼˜æ•…ã€‚</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-built_in">ref</span>erer: http:<span class="hljs-comment">//localhost:4000/</span><br></code></pre></td></tr></table></figure><p>é€šè¿‡åœ¨ <code>img</code> æ·»åŠ  <code>referrer</code> ç­–ç•¥ <code>&lt;img referrerpolicy=&quot;no-referrer&quot;&gt;</code> ï¼Œ<br>å»å¤„å›¾ç‰‡è¯·æ±‚å¸¦ <code>referer</code> å‚æ•°ï¼Œå‘ç°è®¿é—®æˆåŠŸã€‚</p><p>è¯´æ˜è¯­é›€åœ¨æœåŠ¡ç«¯æ£€æµ‹åˆ°å›¾ç‰‡è®¿é—®æ¥æºä¸æ˜¯ <code>yuque.com</code> æ—¶ï¼Œä¼šæ‹’æ¥è®¿é—®ã€‚<br>ä¸ºäº†ä¸€åŠ³æ°¸é€¸ï¼Œæ¯æ¬¡å»æ”¹è¿™ä¸ªå€¼ä¹Ÿä¸æ˜¯ä¸ªäº‹ã€‚</p><p><code>hexo</code> çš„ä¸»é¢˜é‡Œé¢å¯ä»¥é€šè¿‡æ·»åŠ ä¸€ä¸ª <code>filter</code> æ­£åˆ™å¤„ç† <code>img</code> çš„æ·»åŠ å†…è”å‚æ•°ã€‚<br>ä¼šåœ¨æ¯æ¬¡æ–‡ç« æ¸²æŸ“åï¼Œå»åšä¸€æ¬¡æ­£åˆ™æ›¿æ¢ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-meta">&#x27;use strict&#x27;</span><br>hexo.extend.filter.register(<br>  <span class="hljs-string">&#x27;after_post_render&#x27;</span>,<br>  <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>&#123;<br>    <span class="hljs-keyword">const</span> theme = hexo.theme.config;<br>    <span class="hljs-keyword">if</span> (!theme.no_referrer) <span class="hljs-keyword">return</span>;<br>    data.content = data.content.replace(<br>      <span class="hljs-comment">// Match &#x27;img&#x27; tags width the src attribute.</span><br>      <span class="hljs-regexp">/&lt;img([^&gt;]*)src=&quot;([^&quot;]*)&quot;([^&gt;\/]*)\/?\s*&gt;/gim</span>,<br>      <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">match, attrBegin, src, attrEnd</span>) </span>&#123;<br>        <span class="hljs-comment">// Exit if the src doesn&#x27;t exists.</span><br>        <span class="hljs-keyword">if</span> (!src) <span class="hljs-keyword">return</span> match;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">`&lt;img referrerpolicy=&quot;no-referrer&quot;</span><br><span class="hljs-string">                     src=&quot;<span class="hljs-subst">$&#123;src&#125;</span>&quot;</span><br><span class="hljs-string">                &gt;`</span><br>      &#125;<br>    )<br>  &#125;,<br>  <span class="hljs-number">1</span><br>);<br></code></pre></td></tr></table></figure><p>Bingoï¼Œå®Œç¾è§£å†³é—®é¢˜ï¼Œè®©è¯­é›€å……å½“äº†ä¸ªå…è´¹çš„ cdnã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>OC å¯¹è±¡æœ¬è´¨</title>
    <link href="/2021/11/09/nature-of-object/"/>
    <url>/2021/11/09/nature-of-object/</url>
    
    <content type="html"><![CDATA[<p>æˆ‘ä»¬å¹³æ—¶ç¼–å†™çš„Objective-Cä»£ç ï¼Œåº•å±‚å®ç°å…¶å®éƒ½æ˜¯C\C++ä»£ç <br>å¯¹è±¡åŸºäº C çš„ struct æ¥å®ç°çš„<br><img referrerpolicy="no-referrer"                     src="https://cdn.nlark.com/yuque/0/2021/png/12601335/1636359832020-748d612a-a5d5-43a2-9edc-bd2c0a6d8544.png#clientId=u11dac9c6-f8c5-4&from=paste&height=123&id=u2cfb2d29&margin=%5Bobject%20Object%5D&name=image.png&originHeight=246&originWidth=2180&originalType=binary&ratio=1&size=48934&status=done&style=none&taskId=u2af95bb4-91e0-4505-9054-2c7464b1d26&width=1090"                ><br>å‰ç«¯ç¼–è¯‘å™¨æ˜¯ clang<br>â€‹</p><h3 id="OC-è½¬-C"><a href="#OC-è½¬-C" class="headerlink" title="OC è½¬ C++"></a>OC è½¬ C++</h3><p>å°†Objective-Cä»£ç è½¬æ¢ä¸ºC\C++ä»£ç <br><code>xcrun -sdk iphoneos clang  -arch  arm64 -rewrite-objc  OCæºæ–‡ä»¶  -o  è¾“å‡ºçš„CPPæ–‡ä»¶</code><br>å¦‚æœéœ€è¦é“¾æ¥å…¶ä»–æ¡†æ¶ï¼Œä½¿ç”¨<code>-framework</code>å‚æ•°ã€‚æ¯”å¦‚<code>-frameworkUIKit</code><br>â€‹</p><h3 id="OC-åº•å±‚å®ç°"><a href="#OC-åº•å±‚å®ç°" class="headerlink" title="OC åº•å±‚å®ç°"></a>OC åº•å±‚å®ç°</h3><p>NSObjectçš„åº•å±‚å®ç°<br><img referrerpolicy="no-referrer"                     src="https://cdn.nlark.com/yuque/0/2021/png/12601335/1636360273820-7ce7b98d-0a08-4d23-9162-e1d3a17ed400.png#clientId=u11dac9c6-f8c5-4&from=paste&height=207&id=u9e37c026&margin=%5Bobject%20Object%5D&name=image.png&originHeight=414&originWidth=1768&originalType=binary&ratio=1&size=265168&status=done&style=none&taskId=u373712c6-330b-4fd3-8c35-3fac701f552&width=884"                ></p><h3 id="OC-å¯¹è±¡å†…å­˜åˆ†é…"><a href="#OC-å¯¹è±¡å†…å­˜åˆ†é…" class="headerlink" title="OC å¯¹è±¡å†…å­˜åˆ†é…"></a>OC å¯¹è±¡å†…å­˜åˆ†é…</h3><p>ç»“æ„ä½“å†…å­˜å¯¹é½ï¼š ç»“æ„ä½“å¤§å°çš„å¿…é¡»æ˜¯æœ€å¤§æˆå‘˜å¤§å°çš„å€æ•°<br>æ“ä½œç³»ç»Ÿåˆ†é…å†…å­˜æ—¶çš„å†…å­˜å¯¹é½ï¼šæ˜¯ 16 çš„å€æ•°ï¼Œæ–¹ä¾¿æ“ä½œç³»ç»Ÿè¿›è¡Œæ“ä½œ<br>malloc æºç è§„å®šå¯¹è±¡æœ€å°‘ä¹Ÿè¦åˆ†é… 16å­—èŠ‚</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs objectivec"><span class="hljs-comment">// è·å–NSObject ç±»çš„å®ä¾‹æˆå‘˜å¯¹è±¡æ‰€å çš„å¤§å°</span><br><span class="hljs-meta">#import <span class="hljs-meta-string">&lt;objc/runtime.h&gt;</span></span><br>class_getInstanceSize([<span class="hljs-built_in">NSObjectclass</span>]);<br><br><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œå®é™…ä¸Šåˆ†é…äº†å¤šå°‘å†…å­˜</span><br><span class="hljs-meta">#import <span class="hljs-meta-string">&lt;malloc/malloc.h&gt;</span></span><br>malloc_size((__bridgeconstvoid *)obj);<br><br><span class="hljs-comment">// æœ¬è´¨æ˜¯ä¸€ä¸ªè¿ç®—ç¬¦ã€ç¼–è¯‘åå°±å˜æˆå¸¸æ•°</span><br><span class="hljs-keyword">sizeof</span>(ç±»å‹)<br></code></pre></td></tr></table></figure><h3 id="OC-å¯¹è±¡çš„åˆ†ç±»"><a href="#OC-å¯¹è±¡çš„åˆ†ç±»" class="headerlink" title="OC å¯¹è±¡çš„åˆ†ç±»"></a>OC å¯¹è±¡çš„åˆ†ç±»</h3><p><img referrerpolicy="no-referrer"                     src="https://cdn.nlark.com/yuque/0/2021/png/12601335/1636387208461-f7504f4e-aecb-47d7-9cb8-3fafb47af01f.png#clientId=u8a4b0efc-5a91-4&from=paste&height=593&id=u63c69d2d&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1186&originWidth=1138&originalType=binary&ratio=1&size=184831&status=done&style=none&taskId=u518467ac-ac4a-4e39-8ce5-ac39631f3fe&width=569"                ></p><h4 id="instance"><a href="#instance" class="headerlink" title="instance"></a>instance</h4><ol><li><p>isaæŒ‡é’ˆ</p></li><li><p>å…¶ä»–æˆå‘˜å˜é‡</p><h4 id="class"><a href="#class" class="headerlink" title="class"></a>class</h4><p><img referrerpolicy="no-referrer"                     src="https://cdn.nlark.com/yuque/0/2021/png/12601335/1636369535218-d264acd2-00ae-420a-b4c8-9d830e79ec0e.png#clientId=u4804c718-c41e-4&from=paste&height=367&id=ucb310631&margin=%5Bobject%20Object%5D&name=image.png&originHeight=734&originWidth=450&originalType=binary&ratio=1&size=124240&status=done&style=none&taskId=u38e9f4d5-5fea-412e-8ec8-9eb650e1429&width=225"                ></p></li><li><p>isaæŒ‡é’ˆ</p></li><li><p>superclassæŒ‡é’ˆ</p></li><li><p>ç±»çš„å±æ€§ä¿¡æ¯ï¼ˆ@propertyï¼‰ã€ç±»çš„å¯¹è±¡æ–¹æ³•ä¿¡æ¯ï¼ˆinstance methodï¼‰</p></li><li><p>ç±»çš„åè®®ä¿¡æ¯ï¼ˆprotocolï¼‰ã€ç±»çš„æˆå‘˜å˜é‡ä¿¡æ¯ï¼ˆivarï¼‰</p></li><li><p>â€¦â€¦</p></li></ol><h4 id="meta-class"><a href="#meta-class" class="headerlink" title="meta-class"></a>meta-class</h4><p>æ¯ä¸ªç±»åœ¨å†…å­˜ä¸­æœ‰ä¸”åªæœ‰ä¸€ä¸ªmeta-classå¯¹è±¡<br>meta-classå¯¹è±¡å’Œclasså¯¹è±¡çš„å†…å­˜ç»“æ„æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ç”¨é€”ä¸ä¸€æ ·ï¼Œåœ¨å†…å­˜ä¸­å­˜å‚¨çš„ä¿¡æ¯ä¸»è¦åŒ…æ‹¬<br><img referrerpolicy="no-referrer"                     src="https://cdn.nlark.com/yuque/0/2021/png/12601335/1636386599159-74a4833b-5b08-4e40-bd76-9067d3f42e2d.png#clientId=u859ffdfd-0f1a-4&from=paste&height=312&id=u27c8c4f8&margin=%5Bobject%20Object%5D&name=image.png&originHeight=624&originWidth=556&originalType=binary&ratio=1&size=38414&status=done&style=none&taskId=uf202e855-8c1b-409d-9e55-496388d1406&width=278"                ></p><ol><li>isaæŒ‡é’ˆ</li><li>superclassæŒ‡é’ˆ</li><li>ç±»çš„ç±»æ–¹æ³•ä¿¡æ¯ï¼ˆclassmethodï¼‰</li><li>â€¦â€¦</li></ol><p>â€‹</p><p>objc_getClass(const char *aClassName)<br>â€‹</p><p>object_getClass(id obj)<br>â€‹</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>åŒå±‚çº§å¤šä¸ª scrollview æ»šåŠ¨å¦‚åŒåœ¨ä¸€ä¸ª scrollview</title>
    <link href="/2021/11/09/mul-scrollview/"/>
    <url>/2021/11/09/mul-scrollview/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¦‚æœå®ç°å¤šä¸€å±‚çº§çš„å¤šä¸ª scrollview</p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>è‡ªå®šä¹‰Button, çº¦æŸå¸ƒå±€</title>
    <link href="/2019/10/03/ezbutton/"/>
    <url>/2019/10/03/ezbutton/</url>
    
    <content type="html"><![CDATA[<p>é‰´äºç³»ç»Ÿæä¾›çš„UIButton ç”¨èµ·æ¥éå¸¸ä¸æ–¹ä¾¿.<br>è‡ªå®šä¹‰äº†ä¸€ä¸ªEZButton, å†…éƒ¨é€šè¿‡çº¦æŸå¸ƒå±€,.<br>æ”¯æŒå›¾ç‰‡æ–‡å­—,ä¸Šä¸‹/å·¦å³æ’å¸ƒ.<br>æ”¯æŒå±…ä¸­, å±…å·¦, å±…ä¸Š, å±…å³, å±…ä¸‹ç­‰</p><p><a href="https://github.com/JemesL/EZButton">Demo</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>JLSTAT</title>
    <link href="/2019/10/03/jlstat/"/>
    <url>/2019/10/03/jlstat/</url>
    
    <content type="html"><![CDATA[<p>å‰é¢ä¸ºäº†æ–¹ä¾¿ ç»™è§†å›¾æ·»åŠ å¤šçŠ¶æ€æ“ä½œ, æ˜¯é€šè¿‡ç»§æ‰¿çš„æ–¹å¼æ·»åŠ å±æ€§æ¥æ“ä½œçš„.<br>è¿™æ ·çš„ç¼ºç‚¹æ˜¯ä¸å¾—ä¸ä¸ºæ¯ä¸€ä¸ªç©ºé—´éƒ½è¦å†™ä¸€ä¸ªæ§ä»¶å†™ä¸€ä¸ªå­ç±».</p><p>åé¢é€šè¿‡å‚ç…§rxswift, æ¥ç»™æ‰€æœ‰çš„view æ·»åŠ å¤šçŠ¶æ€æ“ä½œ.</p><p>ä¸»è¦ä¹Ÿæ˜¯å…ˆé€šè¿‡ç»™view æ·»åŠ ä¸€ä¸ª jl çš„å‘½åç©ºé—´, ç„¶åå†é€šè¿‡è¿è¡Œæ—¶, ä¸º view å…³è”ä¸€ä¸ªblock.<br>è®¾ç½®çŠ¶æ€æ—¶, å†è°ƒç”¨å…³è”çš„block.</p><p><a href="https://github.com/JemesL/JLSTAT">Demo</a></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-class"><span class="hljs-keyword">extension</span> <span class="hljs-title">JLSpace</span> <span class="hljs-title">where</span> <span class="hljs-title">Base</span>: <span class="hljs-title">UIView</span> </span>&#123;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">setStatBlock</span>&lt;<span class="hljs-type">E</span>&gt;(<span class="hljs-params">defaultValue</span>: <span class="hljs-type">E</span>, <span class="hljs-params">block</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">Base</span>, <span class="hljs-type">E</span>) -&gt; ())</span> &#123;<br>        <span class="hljs-keyword">typealias</span> <span class="hljs-type">STATBE</span> <span class="hljs-operator">=</span> <span class="hljs-type">STAT</span>&lt;<span class="hljs-type">Base</span>, <span class="hljs-type">E</span>&gt;<br>        <span class="hljs-keyword">let</span> stat <span class="hljs-operator">=</span> <span class="hljs-type">STATBE</span>(e: defaultValue, block: block)<br>        objc_setAssociatedObject(<span class="hljs-keyword">self</span>.base, <span class="hljs-operator">&amp;</span><span class="hljs-type">AssociatedKeys</span>.statKey, stat, .<span class="hljs-type">OBJC_ASSOCIATION_RETAIN</span>)<br>        <br>        block(<span class="hljs-keyword">self</span>.base, defaultValue)<br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">setStat</span>&lt;<span class="hljs-type">E</span>&gt;(<span class="hljs-params">e</span>: <span class="hljs-type">E</span>)</span> &#123;<br>        <span class="hljs-keyword">typealias</span> <span class="hljs-type">STATBE</span> <span class="hljs-operator">=</span> <span class="hljs-type">STAT</span>&lt;<span class="hljs-type">Base</span>, <span class="hljs-type">E</span>&gt;<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">var</span> stat <span class="hljs-operator">=</span> objc_getAssociatedObject(<span class="hljs-keyword">self</span>.base, <span class="hljs-operator">&amp;</span><span class="hljs-type">AssociatedKeys</span>.statKey) <span class="hljs-keyword">as?</span> <span class="hljs-type">STATBE</span> &#123;<br>            stat.block<span class="hljs-operator">?</span>(<span class="hljs-keyword">self</span>.base, e)<br>            stat.e <span class="hljs-operator">=</span> e<br>            objc_setAssociatedObject(<span class="hljs-keyword">self</span>.base, <span class="hljs-operator">&amp;</span><span class="hljs-type">AssociatedKeys</span>.statKey, stat, .<span class="hljs-type">OBJC_ASSOCIATION_RETAIN</span>)<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">getStat</span>&lt;<span class="hljs-type">E</span>&gt;()</span> -&gt; <span class="hljs-type">E</span>? &#123;<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> statBlock <span class="hljs-operator">=</span> objc_getAssociatedObject(<span class="hljs-keyword">self</span>.base, <span class="hljs-operator">&amp;</span><span class="hljs-type">AssociatedKeys</span>.statKey) <span class="hljs-keyword">as?</span> <span class="hljs-type">STAT</span>&lt;<span class="hljs-type">Base</span>, <span class="hljs-type">E</span>&gt; &#123;<br>            <span class="hljs-keyword">return</span> statBlock.e<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span><br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">STAT</span>&lt;<span class="hljs-title">Base</span>, <span class="hljs-title">E</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">typealias</span> <span class="hljs-type">STATBLOCK</span> <span class="hljs-operator">=</span> (<span class="hljs-type">Base</span>, <span class="hljs-type">E</span>) -&gt; ()<br>    <br>    <span class="hljs-keyword">var</span> block: <span class="hljs-type">STATBLOCK</span>?<br>    <span class="hljs-keyword">var</span> e: <span class="hljs-type">E</span>?<br>    <span class="hljs-function"><span class="hljs-keyword">init</span>(<span class="hljs-params">e</span>: <span class="hljs-type">E</span>?, <span class="hljs-params">block</span>: <span class="hljs-type">STATBLOCK</span>?)</span> &#123;<br>        <span class="hljs-keyword">self</span>.block <span class="hljs-operator">=</span> block<br>        <span class="hljs-keyword">self</span>.e <span class="hljs-operator">=</span> e<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Swift ç¼–è¯‘ä¼˜åŒ–</title>
    <link href="/2019/07/28/swift-compile/"/>
    <url>/2019/07/28/swift-compile/</url>
    
    <content type="html"><![CDATA[<p>swift æœ‰äº›è¯­æ³•å†™èµ·æ¥å¾ˆä¾¿æ·, ä½†æ˜¯ç¼–è¯‘æ•ˆç‡å´å¾ˆä½.<br>å½“ä»£ç é‡åˆ°ä¸€å®šç¨‹åº¦, ç¼–è¯‘èµ·æ¥, è€—è´¹å¾ˆå¤šæ—¶é—´.</p><p>###ä¸‹é¢æ€»ç»“ä¸€äº›, éƒ¨åˆ†å¯¼è‡´ç¼–è¯‘æ•ˆç‡ä½ä¸‹çš„å†™æ³•.</p><ol><li>ä½¿ç”¨ ?? æ¥è§£åŒ…, å°¤å…¶æ˜¯åœ¨æŸä¸ªè¡¨è¾¾å¼é‡Œé¢ä½¿ç”¨, è¶Šå¤æ‚è¶Šä½æ•ˆ, ä½åˆ°éš¾ä»¥ç½®ä¿¡</li><li>æ•°ç»„æ‹¼æ¥ä½¿ç”¨ + , å»ºè®®ä½¿ç”¨.append æ–¹æ³•è¿›è¡Œ</li><li>å­—ç¬¦ä¸²æ‹¼æ¥ä¸è¦ä½¿ç”¨+, ä½¿ç”¨ â€œ(var)â€</li><li>å¯¹äºå¤æ‚çš„å˜é‡, å»ºè®®å£°æ˜æ—¶å†™ä¸Šç±»å‹</li><li>å¯¹äºåƒif ç±»ä¼¼çš„æ¡ä»¶åˆ¤æ–­é‡Œé¢è¡¨è¾¾å¼ä¸è¦å¤ªå¤æ‚, æ¯”è¾ƒå¤æ‚çš„å¯ä»¥å…ˆç®—å®Œåœ¨æ¥åˆ¤æ–­</li></ol>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Swift æ—¶é—´æ ¼å¼å¤„ç†</title>
    <link href="/2019/03/20/date/"/>
    <url>/2019/03/20/date/</url>
    
    <content type="html"><![CDATA[<h4 id="1-String-gt-Date"><a href="#1-String-gt-Date" class="headerlink" title="1. String -&gt; Date"></a>1. String -&gt; Date</h4><p>æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœå­—ç¬¦ä¸²é‡Œé¢åŒ…å«äº†æ—¶åŒºä¿¡æ¯, é‚£ä¹ˆè®¾ç½® TimeZone æ— æ•ˆ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-class"><span class="hljs-keyword">extension</span> <span class="hljs-title">String</span> </span>&#123;<br>    <span class="hljs-comment">/// String -&gt; Date</span><br>    <span class="hljs-comment">///</span><br>    <span class="hljs-comment">/// - Parameters:</span><br>    <span class="hljs-comment">///   - format: åŸæ—¶é—´å­—ç¬¦ä¸²çš„æ ¼å¼</span><br>    <span class="hljs-comment">///   - timeZone: è¯¥å­—ç¬¦ä¸²çš„æ—¶åŒº(è‹¥å­—ç¬¦ä¸²è‡ªå¸¦æ—¶åŒºä¿¡æ¯, åˆ™è¯¥è®¾ç½®æ— æ•ˆ), default: å½“å‰æ—¶åŒº</span><br>    <span class="hljs-comment">/// - Returns: Date</span><br>    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">toDate</span>(<span class="hljs-params">format</span>: <span class="hljs-type">String</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;yyyy-MM-dd&#x27;T&#x27;HH:mm:ss.SSSZ&quot;</span>, <span class="hljs-params">timeZone</span>: <span class="hljs-type">TimeZone</span>? <span class="hljs-operator">=</span> .current)</span> -&gt; <span class="hljs-type">Date</span>? &#123;<br>        <span class="hljs-keyword">let</span> formatter <span class="hljs-operator">=</span> <span class="hljs-type">DateFormatter</span>()<br>        formatter.timeZone <span class="hljs-operator">=</span> timeZone<br>        formatter.dateFormat <span class="hljs-operator">=</span> format<br>        <span class="hljs-keyword">return</span> formatter.date(from: <span class="hljs-keyword">self</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚ä¸‹ æ— è®ºæ—¶åŒºè®¾ç½®æˆä»€ä¹ˆ, ç»“æœéƒ½ä¸€æ ·</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">var</span> str1 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;2019-03-20T09:48:55.801Z&quot;</span><br><span class="hljs-comment">// ä¸œå…«åŒº</span><br><span class="hljs-keyword">let</span> date11 <span class="hljs-operator">=</span> str1.toDate(timeZone: <span class="hljs-type">TimeZone</span>(secondsFromGMT: <span class="hljs-number">28800</span>)) <span class="hljs-comment">//&quot;Mar 20, 2019 at 5:48 PM&quot;</span><br><span class="hljs-comment">// é›¶æ—¶åŒº</span><br><span class="hljs-keyword">let</span> date12 <span class="hljs-operator">=</span> str1.toDate(timeZone: <span class="hljs-type">TimeZone</span>(secondsFromGMT: <span class="hljs-number">0</span>))     <span class="hljs-comment">//&quot;Mar 20, 2019 at 5:48 PM&quot;</span><br></code></pre></td></tr></table></figure><p>ä¸åŒ…å«æ—¶åŒºä¿¡æ¯æ—¶, è¿™æ—¶å€™æ—¶åŒºä¸åŒæ˜¯æœ‰å½±å“çš„</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">var</span> str2 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;2019-03-20 20:48:55&quot;</span><br><span class="hljs-comment">// ä¸œå…«åŒº</span><br><span class="hljs-keyword">let</span> date21 <span class="hljs-operator">=</span> str2.toDate(format: <span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>, timeZone: <span class="hljs-type">TimeZone</span>(secondsFromGMT: <span class="hljs-number">28800</span>)) <span class="hljs-comment">//&quot;Mar 20, 2019 at 8:48 PM&quot;</span><br><span class="hljs-comment">// é›¶æ—¶åŒº</span><br><span class="hljs-keyword">let</span> date22 <span class="hljs-operator">=</span> str2.toDate(format: <span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>, timeZone: <span class="hljs-type">TimeZone</span>(secondsFromGMT: <span class="hljs-number">0</span>))     <span class="hljs-comment">//&quot;Mar 21, 2019 at 4:48 AM&quot;</span><br></code></pre></td></tr></table></figure><h4 id="2-Date-gt-String"><a href="#2-Date-gt-String" class="headerlink" title="2. Date -&gt; String"></a>2. Date -&gt; String</h4><p>æ­¤æ—¶, è®¾ç½® timeZone å°†ä¼šæŠŠæ—¶é—´è½¬æˆæ—¶åŒºå½“åœ°æ—¶é—´å¹¶æŒ‰æ ¼å¼å±•ç¤º</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-class"><span class="hljs-keyword">extension</span> <span class="hljs-title">Date</span> </span>&#123;<br>    <span class="hljs-comment">/// Date -&gt; String</span><br>    <span class="hljs-comment">///</span><br>    <span class="hljs-comment">/// - Parameter</span><br>    <span class="hljs-comment">///   - format: éœ€è¦è½¬ä¸ºçš„æ—¶é—´æ ¼å¼</span><br>    <span class="hljs-comment">///   - timeZone: å±•ç¤ºçš„æ—¶é—´æ—¶åŒº, default: å½“å‰æ—¶åŒº</span><br>    <span class="hljs-comment">/// - Returns: String</span><br>    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">toString</span>(<span class="hljs-params">format</span>: <span class="hljs-type">String</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>, <span class="hljs-params">timeZone</span>: <span class="hljs-type">TimeZone</span>? <span class="hljs-operator">=</span> .current)</span> -&gt; <span class="hljs-type">String</span> &#123;<br>        <span class="hljs-type">NSTimeZone</span>.resetSystemTimeZone()<br>        <span class="hljs-keyword">let</span> formatter <span class="hljs-operator">=</span> <span class="hljs-type">DateFormatter</span>()<br>        formatter.timeZone <span class="hljs-operator">=</span> timeZone<br>        formatter.dateFormat <span class="hljs-operator">=</span> format<br><br>        formatter.locale <span class="hljs-operator">=</span> <span class="hljs-type">Locale</span>(identifier: <span class="hljs-string">&quot;zh_CN&quot;</span>)<br>        <span class="hljs-keyword">return</span> formatter.string(from: <span class="hljs-keyword">self</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚ä¸‹:</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-comment">// é›¶æ—¶åŒº</span><br>date3<span class="hljs-operator">?</span>.toString(format: <span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>, timeZone: <span class="hljs-type">TimeZone</span>(secondsFromGMT: <span class="hljs-number">0</span>))     <span class="hljs-comment">//&quot;2019-03-20 12:48:55&quot;</span><br><span class="hljs-comment">// ä¸œå…«åŒº</span><br>date3<span class="hljs-operator">?</span>.toString(format: <span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>, timeZone: <span class="hljs-type">TimeZone</span>(secondsFromGMT: <span class="hljs-number">28800</span>)) <span class="hljs-comment">//&quot;2019-03-20 20:48:55&quot;</span><br></code></pre></td></tr></table></figure><h4 id="3-Date-gt-String-ç±»ä¼¼æœ‹å‹åœˆçš„æ—¶é—´æ ¼å¼"><a href="#3-Date-gt-String-ç±»ä¼¼æœ‹å‹åœˆçš„æ—¶é—´æ ¼å¼" class="headerlink" title="3. Date -&gt; String(ç±»ä¼¼æœ‹å‹åœˆçš„æ—¶é—´æ ¼å¼)"></a>3. Date -&gt; String(ç±»ä¼¼æœ‹å‹åœˆçš„æ—¶é—´æ ¼å¼)</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TimeTool</span> </span>&#123;<br>    <span class="hljs-comment">/// Date -&gt; String(æœ‹å‹åœˆæ—¶é—´æ˜¾ç¤ºæ ¼å¼)</span><br>    <span class="hljs-comment">///</span><br>    <span class="hljs-comment">/// - Parameter with: Date</span><br>    <span class="hljs-comment">/// - Returns: String</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">toMsgTime</span>(<span class="hljs-params">with</span> <span class="hljs-params">date</span>: <span class="hljs-type">Date</span>)</span> -&gt; <span class="hljs-type">String</span>? &#123;<br>        <span class="hljs-keyword">let</span> sinceDate <span class="hljs-operator">=</span> date<br>        <span class="hljs-keyword">let</span> curDate <span class="hljs-operator">=</span> <span class="hljs-type">Date</span>()<br>        <span class="hljs-keyword">let</span> i: <span class="hljs-type">Int</span> <span class="hljs-operator">=</span> <span class="hljs-type">Int</span>(curDate.timeIntervalSince(sinceDate))<br><br>        <span class="hljs-keyword">let</span> minute: <span class="hljs-type">Int</span> <span class="hljs-operator">=</span> <span class="hljs-number">60</span><br>        <span class="hljs-keyword">let</span> hour: <span class="hljs-type">Int</span> <span class="hljs-operator">=</span> minute <span class="hljs-operator">*</span> <span class="hljs-number">60</span><br>        <span class="hljs-keyword">let</span> day: <span class="hljs-type">Int</span> <span class="hljs-operator">=</span> hour <span class="hljs-operator">*</span> <span class="hljs-number">24</span><br>        <span class="hljs-keyword">let</span> month: <span class="hljs-type">Int</span> <span class="hljs-operator">=</span> day <span class="hljs-operator">*</span> <span class="hljs-number">30</span> <span class="hljs-comment">// å¹³å‡å€¼</span><br>        <span class="hljs-keyword">let</span> year: <span class="hljs-type">Int</span> <span class="hljs-operator">=</span> month <span class="hljs-operator">*</span> <span class="hljs-number">12</span><br><br>        <span class="hljs-keyword">var</span> str <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">switch</span> i &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span>minute:<br>            str <span class="hljs-operator">=</span> <span class="hljs-string">&quot;åˆšåˆš&quot;</span><br>        <span class="hljs-keyword">case</span> minute<span class="hljs-operator">..&lt;</span>hour:<br>            str <span class="hljs-operator">=</span> <span class="hljs-string">&quot;<span class="hljs-subst">\(i<span class="hljs-operator">/</span>minute)</span> åˆ†é’Ÿå‰&quot;</span><br>        <span class="hljs-keyword">case</span> hour<span class="hljs-operator">..&lt;</span>day:<br>            str <span class="hljs-operator">=</span> <span class="hljs-string">&quot;<span class="hljs-subst">\(i<span class="hljs-operator">/</span>hour)</span> å°æ—¶å‰&quot;</span><br>        <span class="hljs-keyword">case</span> day<span class="hljs-operator">..&lt;</span>month:<br>            str <span class="hljs-operator">=</span> <span class="hljs-string">&quot;<span class="hljs-subst">\(i<span class="hljs-operator">/</span>day)</span> å¤©å‰&quot;</span><br>        <span class="hljs-keyword">case</span> month<span class="hljs-operator">..&lt;</span>year:<br>            str <span class="hljs-operator">=</span> <span class="hljs-string">&quot;<span class="hljs-subst">\(i<span class="hljs-operator">/</span>month)</span> æœˆå‰&quot;</span><br>        <span class="hljs-keyword">case</span> year<span class="hljs-operator">..&lt;</span><span class="hljs-type">LONG_MAX</span>:<br>            str <span class="hljs-operator">=</span> <span class="hljs-string">&quot;<span class="hljs-subst">\(i<span class="hljs-operator">/</span>year)</span> å¹´å‰&quot;</span><br>        <span class="hljs-keyword">default</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span><br>        &#125;<br>        <span class="hljs-keyword">return</span> str<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><a href="http://www.unicode.org/reports/tr35/tr35-25.html#Date_Format_Patterns">Date Format Patternsæ”¯æŒçš„æ ¼å¼</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Swift ç¼–è¯‘ä¼˜åŒ–</title>
    <link href="/2019/03/07/swift-build-optimizing/"/>
    <url>/2019/03/07/swift-build-optimizing/</url>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰æ¯æ¬¡ç¼–è¯‘, éœ€è¦èŠ±è´¹å¤ªé•¿æ—¶é—´. ç”šè‡³æ”¹ä¸€è¡Œä»£ç ä¹Ÿæ˜¯å¦‚æ­¤.<br>åé¢èŠ±äº†ä¸€äº›æ—¶é—´å»åšä¼˜åŒ–</p><h3 id="æ˜¾ç¤ºç¼–è¯‘è€—æ—¶è¿‡é•¿çš„è­¦å‘Š"><a href="#æ˜¾ç¤ºç¼–è¯‘è€—æ—¶è¿‡é•¿çš„è­¦å‘Š" class="headerlink" title="æ˜¾ç¤ºç¼–è¯‘è€—æ—¶è¿‡é•¿çš„è­¦å‘Š"></a>æ˜¾ç¤ºç¼–è¯‘è€—æ—¶è¿‡é•¿çš„è­¦å‘Š</h3><p>target -&gt; buildsetting -&gt; Other Swift Flags -&gt; Debug<br>æ·»åŠ <br>-Onone<br>-Xfrontend<br>-warn-long-function-bodies=100 // æ£€æµ‹å‡½æ•°ä½“çš„ ç±»å‹æ£€æŸ¥ 100ms æ˜¯è­¦å‘Šçš„ä¸Šé™<br>-Xfrontend<br>-warn-long-expression-type-checking=100 // æ£€æŸ¥è¡¨è¾¾å¼</p><h3 id="å¤šçº¿ç¨‹build"><a href="#å¤šçº¿ç¨‹build" class="headerlink" title="å¤šçº¿ç¨‹build"></a>å¤šçº¿ç¨‹build</h3><p>scheme çš„ build é¡µé¢<br>å‹¾ä¸Š Parallelize Build</p><h3 id="å•æ–‡ä»¶-å¢é‡ç¼–è¯‘"><a href="#å•æ–‡ä»¶-å¢é‡ç¼–è¯‘" class="headerlink" title="å•æ–‡ä»¶ å¢é‡ç¼–è¯‘"></a>å•æ–‡ä»¶ å¢é‡ç¼–è¯‘</h3><p>target -&gt; buildsetting -&gt; SWIFT_WHOLE_MODULE_OPTIMIZATION<br>è®¾ç½®ä¸ºNO</p><h3 id="ç¼–è¯‘æ¨¡å¼"><a href="#ç¼–è¯‘æ¨¡å¼" class="headerlink" title="ç¼–è¯‘æ¨¡å¼"></a>ç¼–è¯‘æ¨¡å¼</h3><p>target -&gt; buildsetting -&gt; compilation mode<br>è®¾ç½®ä¸º incremental å¢é‡æ¨¡å¼</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€ä¸ªæ¯”è¾ƒå°‘è§çš„å¾ªç¯å¼•ç”¨</title>
    <link href="/2019/01/09/arc/"/>
    <url>/2019/01/09/arc/</url>
    
    <content type="html"><![CDATA[<p>å¾ªç¯å¼•ç”¨åº”è¯¥å¤§éƒ¨åˆ†äººéƒ½çŸ¥é“æ€ä¹ˆå›äº‹.</p><h4 id="è¾ƒå¸¸è§çš„å°±æœ‰"><a href="#è¾ƒå¸¸è§çš„å°±æœ‰" class="headerlink" title="è¾ƒå¸¸è§çš„å°±æœ‰"></a>è¾ƒå¸¸è§çš„å°±æœ‰</h4><ul><li>Aå®ä¾‹ å¼ºå¼•ç”¨ Bå®ä¾‹, B å¼ºå¼•ç”¨ A.</li><li>Aå®ä¾‹å¼ºå¼•ç”¨ Block B, B é‡Œé¢ è°ƒç”¨äº†self</li></ul><p>åœ¨å¼€å‘çš„æ—¶å€™å‘ç°å¦ä¸€ä¸ªç±»å‹, ä¸è¿‡æœ‰ç‚¹ç±»ä¼¼ä¸Šè¿°çš„ç¬¬äºŒä¸ª</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">import</span> Foundation<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;<br><br>    <span class="hljs-keyword">var</span> info: <span class="hljs-type">Info</span>?<br><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Info</span> </span>&#123;<br>        <span class="hljs-keyword">var</span> name: <span class="hljs-type">String</span><br>        <span class="hljs-keyword">var</span> family: <span class="hljs-type">String</span><br>        <span class="hljs-keyword">var</span> age: <span class="hljs-type">Int</span><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">printInfo</span>()</span> &#123;<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> info <span class="hljs-operator">=</span> info &#123;<br>            <span class="hljs-built_in">print</span>(info)<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">transform</span>()</span> -&gt; <span class="hljs-type">Info</span> &#123;<br>        <span class="hljs-keyword">self</span>.info <span class="hljs-operator">=</span> <span class="hljs-type">Info</span>(<br>            name: <span class="hljs-string">&quot;å´å½¦ç¥–&quot;</span>,<br>            family: <span class="hljs-string">&quot;å´æ°å®¶æ—&quot;</span>,<br>            age: <span class="hljs-number">20</span><br>        )<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>.info<span class="hljs-operator">!</span><br>    &#125;<br><br>    <span class="hljs-keyword">deinit</span> &#123;<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;deinit&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">let</span> block <span class="hljs-operator">=</span> &#123;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;begin&quot;</span>)<br>    <span class="hljs-keyword">let</span> p <span class="hljs-operator">=</span> <span class="hljs-type">Person</span>()<br>    p.transform()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-type">CFGetRetainCount</span>(p <span class="hljs-keyword">as</span> <span class="hljs-type">CFTypeRef</span>))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;end&quot;</span>)<br>&#125;<br>block()<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç  run ä¸€ä¸‹ ç»“æœå¦‚ä¸‹, </p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Swift">begin<br><span class="hljs-number">2</span><br>end<br><span class="hljs-keyword">deinit</span><br></code></pre></td></tr></table></figure><p>æ‰“å° deinit äº†,è¯´æ˜ p æ­£å¸¸é‡Šæ”¾äº†, æ²¡æœ‰å¾ªç¯å¼•ç”¨</p><p>ç„¶åç°åœ¨æ”¹ä¸€ä¸‹ Struct Info å’Œ transform æ–¹æ³•, åœ¨é‡Œé¢æ·»åŠ  prinfFunc æ–¹æ³•</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Info</span> </span>&#123;<br>    <span class="hljs-keyword">var</span> name: <span class="hljs-type">String</span><br>    <span class="hljs-keyword">var</span> family: <span class="hljs-type">String</span><br>    <span class="hljs-keyword">var</span> age: <span class="hljs-type">Int</span><br>    <span class="hljs-keyword">var</span> printFunc: () -&gt; ()<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">transform</span>()</span> -&gt; <span class="hljs-type">Info</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-type">Info</span>(<br>        name: <span class="hljs-string">&quot;å´å½¦ç¥–&quot;</span>,<br>        family: <span class="hljs-string">&quot;å´æ°å®¶æ—&quot;</span>,<br>        age: <span class="hljs-number">20</span>,<br>        printFunc: printInfo<br>    )<br>&#125;<br></code></pre></td></tr></table></figure><p>å†æ¬¡ run ä¸€ä¸‹, æ‰“å°ç»“æœå¦‚ä¸‹</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Swift">begin<br><span class="hljs-number">3</span><br>end<br><span class="hljs-keyword">deinit</span><br></code></pre></td></tr></table></figure><p>ä¾æ—§å¯ä»¥æ‰“å°å‡º deinit, ä½†æ˜¯ p çš„å¼•ç”¨è®¡æ•° +1.<br>è¯´æ˜åœ¨ struct é‡Œé¢æŒæœ‰ æŸå®ä¾‹çš„æ–¹æ³•ä¼šè®©è¯¥å®ä¾‹å¼•ç”¨è®¡æ•° +1.</p><p>ç°åœ¨å¦‚æœæŠŠ transform è°ƒæ•´å¦‚ä¸‹, è¿”å› info ä¹‹å‰è®© èµ‹å€¼ç»™ self.info</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">transform</span>()</span> -&gt; <span class="hljs-type">Info</span> &#123;<br>    <span class="hljs-keyword">self</span>.info <span class="hljs-operator">=</span> <span class="hljs-type">Info</span>(<br>        name: <span class="hljs-string">&quot;å´å½¦ç¥–&quot;</span>,<br>        family: <span class="hljs-string">&quot;å´æ°å®¶æ—&quot;</span>,<br>        age: <span class="hljs-number">20</span>,<br>        printFunc: printInfo<br>    )<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>.info<span class="hljs-operator">!</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰“å°å¦‚ä¸‹:</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Swift">begin<br><span class="hljs-number">3</span><br>end<br></code></pre></td></tr></table></figure><p>è¿™ä¸€æ¬¡æ²¡æœ‰ deinit, p æ²¡æœ‰è¢«é‡Šæ”¾, å½¢æˆäº†å¾ªç¯å¼•ç”¨.<br>é€ æˆè¿™ä¸ªå¾ªç¯ä¸»è¦æ˜¯æ²¡æƒ³åˆ° struct é‡Œé¢æŒæœ‰æ–¹æ³•, ä¹Ÿä¼šé€ æˆè®¡æ•° +1.</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Xcode åˆ©ç”¨æ­£åˆ™è¿›è¡Œæœç´¢&amp;æ›¿æ¢</title>
    <link href="/2018/12/17/xcode-regular/"/>
    <url>/2018/12/17/xcode-regular/</url>
    
    <content type="html"><![CDATA[<p>è¿™é‡Œè¯´çš„æ­£åˆ™ä¸æ˜¯æŒ‡çš„swifté‡Œçš„æ­£åˆ™ï¼Œè€Œæ˜¯xcodeè‡ªå¸¦çš„æœç´¢æ›¿æ¢åŠŸèƒ½ä¸­ä½¿ç”¨æ­£åˆ™æ¥ä¿®æ”¹æ–‡ä»¶ä»£ç ã€‚<br>ä¹‹å‰æœ‰ä¸ªéœ€æ±‚å°±æ˜¯å¤šäººå¼€å‘çš„é¡¹ç›®ï¼Œç”±äºä¸ªäººé£æ ¼åŸå› ï¼Œå¯¼è‡´éƒ¨åˆ†ä»£ç ä¹¦å†™è§„èŒƒä¸ä¸€è‡´ã€‚<br>ä½†æ˜¯é¡¹ç›®å·²ç»å¾ˆå¤§äº†ï¼Œå·®ä¸å¤šä¹Ÿæœ‰è¿‘ä¸ƒä¸‡è¡Œä»£ç ã€‚æƒ³æ‰‹åŠ¨ä¸€ä¸ªä¸€ä¸ªå»æ”¹æ˜¯ä¸å¤ªç°å®çš„ï¼Œæ‰€ä»¥æƒ³åˆ°æ­£åˆ™ã€‚<br>äºæ˜¯å»æœäº†æœï¼Œå‘ç°xcodeè‡ªå¸¦è¿™ä¸ªåŠŸèƒ½ï¼Œè¿™ä¸‹æ­£å¥½çœäº‹äº†ã€‚</p><p>è‡³äºæ­£åˆ™è§„åˆ™å¦‚ä½•ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šæ•™ç¨‹ï¼Œå°±ä¸å¤šè¯´äº†ã€‚</p><h4 id="1-åˆ‡æ¢-Find-Replace-æ¨¡å¼"><a href="#1-åˆ‡æ¢-Find-Replace-æ¨¡å¼" class="headerlink" title="1. åˆ‡æ¢ Find/Replace æ¨¡å¼"></a>1. åˆ‡æ¢ Find/Replace æ¨¡å¼</h4><p>æŒ‰Command+Shift+F / Command+F å¿«æ·é”®å¿«é€Ÿè¿›å…¥Find æ¨¡å¼ï¼Œç‚¹å‡»Findåç¬¬äºŒä¸ªç®­å¤´ï¼Œå¯ä»¥åˆ‡æ¢æŸ¥æ‰¾æ¨¡å¼è‡³ Regular Expressionã€‚<br>åœ¨ä¸‹é¢çš„è¾“å…¥æ¡†å°±å¯ä»¥è¾“å…¥æ­£åˆ™è¡¨è¾¾å¼æ¥è¿›è¡ŒæŸ¥è¯¢æ›¿æ¢</p><h3 id="2-ä¸¾ä¸ªğŸŒ°"><a href="#2-ä¸¾ä¸ªğŸŒ°" class="headerlink" title="2. ä¸¾ä¸ªğŸŒ°"></a>2. ä¸¾ä¸ªğŸŒ°</h3><p>ç°åœ¨éœ€è¦ä¼˜åŒ–ä¸€ä¸‹ä»£ç ä¹¦å†™è§„èŒƒï¼Œéœ€è¦æ¯ä¸ªå†’å·åé¢éƒ½éœ€è¦æ·»åŠ ç©ºæ ¼<br>åœ¨Find æ å¡«å…¥ <strong>â€œ:([^\s])â€</strong> ,ä¼šåŒ¹é…å†’å·åå¸¦ä»»ä½•éç©ºå­—ç¬¦<br>ä¸ºäº†é¿å…åŒ¹é…ä¸Š <strong>â€œ[:]â€</strong> æˆ–è€… <strong>â€œhttp://â€œ</strong> çš„æƒ…å†µ<br>å¯ä»¥æ”¹ä¸º <strong>â€œ:([^\s/]])â€</strong></p><p>å¦‚æœéœ€è¦æ›¿æ¢æˆå¸¦ç©ºæ ¼çš„ï¼Œåˆ™åˆ‡åˆ°Replace æ¨¡å¼<br>åœ¨Replace ä¸€æ å¡«å…¥ <strong>â€œ: $1â€</strong><br><strong>â€œ$1â€</strong> æ˜¯Find ä¸­æ­£åˆ™è¡¨è¾¾å¼ä¸­åœ†æ‹¬å·åŒ¹é…åˆ°çš„å†…å®¹</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Swift 4.0 ç¼–ç è§„èŒƒ</title>
    <link href="/2018/12/05/swiftcode/"/>
    <url>/2018/12/05/swiftcode/</url>
    
    <content type="html"><![CDATA[<h3 id="1-ç¼–ç æ ¼å¼"><a href="#1-ç¼–ç æ ¼å¼" class="headerlink" title="1.ç¼–ç æ ¼å¼"></a>1.ç¼–ç æ ¼å¼</h3><ul><li><p>æ¯è¡Œæœ€å¤š160ä¸ªå­—ç¬¦ï¼Œè¿™æ ·å¯ä»¥é¿å…ä¸€è¡Œè¿‡é•¿ã€‚ (Xcode-&gt;Preferences-&gt;Text Editing-&gt;Page guide at column: è®¾ç½®æˆ160å³å¯)</p></li><li><p>ç¡®ä¿æ¯è¡Œéƒ½ä¸ä»¥ç©ºç™½å­—ç¬¦ä½œä¸ºç»“å°¾ ï¼ˆXcode-&gt;Preferences-&gt;Text Editing-&gt;Automatically trim trailing whitespace + Including whitespace-only lines).</p></li><li><p>ä½¿ç”¨äºŒå…ƒè¿ç®—ç¬¦(+, -ï¼Œ==, æˆ–-&gt;)çš„å‰åéƒ½éœ€è¦æ·»åŠ ç©ºæ ¼</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">let</span> value <span class="hljs-operator">=</span> (<span class="hljs-number">1</span> <span class="hljs-operator">+</span> <span class="hljs-number">2</span>) <span class="hljs-operator">*</span> <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure></li><li><p>åœ¨é€—å·ã€å†’å·åé¢åŠ ä¸€ä¸ªç©ºæ ¼</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">let</span> arr <span class="hljs-operator">=</span> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<br><span class="hljs-keyword">let</span> dict <span class="hljs-operator">=</span> [<span class="hljs-string">&quot;123&quot;</span>: <span class="hljs-number">123</span>]<br></code></pre></td></tr></table></figure></li><li><p>æ–¹æ³•çš„å·¦å¤§æ‹¬å·ä¸è¦å¦èµ·ï¼Œå¹¶å’Œæ–¹æ³•åä¹‹é—´ç•™æœ‰ç©ºæ ¼ï¼Œæ³¨é‡Šç©ºæ ¼</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-comment">// æ³¨é‡Š</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">makeSomething</span> </span>&#123;<br>  <span class="hljs-comment">// coding</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>åˆ¤æ–­è¯­å¥ä¸ç”¨æ‹¬å·</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">if</span> isTrue <span class="hljs-operator">=</span> <span class="hljs-literal">true</span> &#123;<br>  <span class="hljs-comment">// coding</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>æ–¹æ³•çš„å·¦å¤§æ‹¬å·ä¸è¦å¦èµ·ï¼Œå¹¶å’Œæ–¹æ³•åä¹‹é—´ç•™æœ‰ç©ºæ ¼ï¼Œæ³¨é‡Šç©ºæ ¼</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">if</span> isTrue <span class="hljs-operator">=</span> <span class="hljs-literal">true</span> &#123;<br>  <span class="hljs-comment">// coding</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>å°½é‡ä¸ä½¿ç”¨self. é™¤éæ–¹æ³•å‚æ•°ä¸å±æ€§åŒå</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">setContent</span>(<span class="hljs-params">name</span>: <span class="hljs-type">String</span>, <span class="hljs-params">count</span>: <span class="hljs-type">Int</span>)</span> &#123;<br>    <span class="hljs-keyword">self</span>.name <span class="hljs-operator">=</span> name<br>    c <span class="hljs-operator">=</span> count<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>åœ¨è®¿é—®æšä¸¾ç±»å‹æ—¶ï¼Œä½¿ç”¨æ›´ç®€æ´çš„ç‚¹è¯­æ³•</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">ShareToPlatform</span> </span>&#123;<br>  <span class="hljs-keyword">case</span> <span class="hljs-type">WX</span><br>  <span class="hljs-keyword">case</span> <span class="hljs-type">TimeLine</span><br>  <span class="hljs-keyword">case</span> <span class="hljs-type">QQ</span><br>  <span class="hljs-keyword">case</span> <span class="hljs-type">Sina</span><br>&#125;<br><span class="hljs-keyword">let</span> platform <span class="hljs-operator">=</span> .<span class="hljs-type">QQ</span><br></code></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ // MARK: -ï¼ŒæŒ‰åŠŸèƒ½ã€åè®®ã€ä»£ç†ç­‰åˆ†ç»„</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-comment">// MARK: - UITableViewDelegate</span><br><br><span class="hljs-comment">// MARK: - Action</span><br><br><span class="hljs-comment">// MARK: - Request</span><br></code></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨extension éš”ç¦»æ–¹æ³•é›†ï¼Œç›¸å…³åè®®ã€ç±»ä¼¼åŠŸèƒ½æ”¾åœ¨ä¸€ä¸ªextensioné‡Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-comment">// MARK: - UICollectionViewDelegate</span><br><span class="hljs-class"><span class="hljs-keyword">extension</span> <span class="hljs-title">JLViewController</span>: <span class="hljs-title">UICollectionViewDelegate</span> </span>&#123;<br><span class="hljs-comment">// ä»£ç†æ–¹æ³•</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>å½“å¯¹å¤–æ¥å£ä¸å…¼å®¹æ—¶ï¼Œä½¿ç”¨@available(iOS x.0, *) æ ‡æ˜æ¥å£é€‚é…çš„èµ·å§‹ç³»ç»Ÿç‰ˆæœ¬å·</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">@available</span>(<span class="hljs-keyword">iOS</span> <span class="hljs-number">10.0</span>, <span class="hljs-operator">*</span>)<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">handleSome</span>()</span> &#123;<br>    <span class="hljs-comment">//</span><br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="2-å‘½åè§„èŒƒ"><a href="#2-å‘½åè§„èŒƒ" class="headerlink" title="2.å‘½åè§„èŒƒ"></a>2.å‘½åè§„èŒƒ</h3><ul><li>å¸¸é‡ï¼Œå˜é‡ï¼Œå‡½æ•°ï¼Œæ–¹æ³•çš„å‘½åè§„åˆ™ä½¿ç”¨å°é©¼å³°è§„åˆ™ï¼Œé¦–å­—æ¯å°å†™ï¼Œç±»å‹åä½¿ç”¨å¤§é©¼å³°è§„åˆ™ï¼Œé¦–å­—æ¯å¤§å†™ã€‚<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">@available</span>(<span class="hljs-keyword">iOS</span> <span class="hljs-number">10.0</span>, <span class="hljs-operator">*</span>)<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">handleSome</span>()</span> &#123;<br>    <span class="hljs-comment">//</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li>å½“å‘½åé‡Œå‡ºç°ç¼©å†™è¯æ—¶ï¼Œç¼©å†™è¯è¦ä¹ˆå…¨éƒ¨å¤§å†™ï¼Œè¦ä¹ˆå…¨éƒ¨å°å†™ï¼Œä»¥é¦–å­—æ¯å¤§å°å†™ä¸ºå‡†<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">let</span> htmlString <span class="hljs-operator">=</span> <span class="hljs-string">&quot;https://www.baidu.com&quot;</span><br><span class="hljs-keyword">let</span> urlString:  <span class="hljs-type">URLString</span><br><span class="hljs-keyword">let</span> userID:  <span class="hljs-type">UserID</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HTMLModel</span> </span>&#123;<br>    <span class="hljs-comment">//</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li>boolç±»å‹å‘½åæ—¶ï¼Œä½¿ç”¨isä½œä¸ºå‰ç¼€<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">var</span> isHave: <span class="hljs-type">Bool</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure></li><li>ä½¿ç”¨å‰ç¼€ k + å¤§éª†é©¼å‘½åæ³• ä¸ºæ‰€æœ‰éå•ä¾‹çš„é™æ€å¸¸é‡å‘½åã€‚<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClassName</span> </span>&#123;<br>    <span class="hljs-comment">// åŸºå…ƒå¸¸é‡ä½¿ç”¨ k ä½œä¸ºå‰ç¼€</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">let</span> kSomeConstantHeight: <span class="hljs-type">CGFloat</span> <span class="hljs-operator">=</span> <span class="hljs-number">80.0</span><br>    <span class="hljs-comment">// éåŸºå…ƒå¸¸é‡ä¹Ÿæ˜¯ç”¨ k ä½œä¸ºå‰ç¼€</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">let</span> kDeleteButtonColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.redColor()<br>    <span class="hljs-comment">// å¯¹äºå•ä¾‹ä¸è¦ä½¿ç”¨kä½œä¸ºå‰ç¼€</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">let</span> sharedInstance <span class="hljs-operator">=</span> <span class="hljs-type">MyClassName</span>()<br>    <span class="hljs-comment">/* ... */</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-ä»£ç é£æ ¼"><a href="#3-ä»£ç é£æ ¼" class="headerlink" title="3.ä»£ç é£æ ¼"></a>3.ä»£ç é£æ ¼</h3></li><li>å¦‚æœéœ€è¦æŠŠè®¿é—®ä¿®é¥°ç¬¦æ”¾åˆ°ç¬¬ä¸€ä¸ªä½ç½®ã€‚</li><li>å°½å¯èƒ½çš„å¤šä½¿ç”¨letï¼Œå°‘ä½¿ç”¨varã€‚</li><li>å½“éœ€è¦éå†ä¸€ä¸ªé›†åˆå¹¶å˜å½¢æˆå¦ä¸€ä¸ªé›†åˆæ—¶ï¼Œæ¨èä½¿ç”¨å‡½æ•° map, filter å’Œ reduceã€‚<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-comment">// æ¨è</span><br><span class="hljs-keyword">let</span> stringOfInts <span class="hljs-operator">=</span> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>].flatMap &#123; <span class="hljs-type">String</span>(<span class="hljs-variable">$0</span>) &#125;<br><span class="hljs-comment">// [&quot;1&quot;, &quot;2&quot;, &quot;3&quot;]</span><br><span class="hljs-comment">// ä¸æ¨è</span><br><span class="hljs-keyword">var</span> stringOfInts: [<span class="hljs-type">String</span>] <span class="hljs-operator">=</span> []<br><span class="hljs-keyword">for</span> integer <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>] &#123;<br>    stringOfInts.append(<span class="hljs-type">String</span>(integer))<br>&#125;<br><span class="hljs-comment">// æ¨è</span><br><span class="hljs-keyword">let</span> evenNumbers <span class="hljs-operator">=</span> [<span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">23</span>, <span class="hljs-number">42</span>].filter &#123; <span class="hljs-variable">$0</span> <span class="hljs-operator">%</span> <span class="hljs-number">2</span> <span class="hljs-operator">==</span> <span class="hljs-number">0</span> &#125;<br><span class="hljs-comment">// [4, 8, 16, 42]</span><br><span class="hljs-comment">// ä¸æ¨è</span><br><span class="hljs-keyword">var</span> evenNumbers: [<span class="hljs-type">Int</span>] <span class="hljs-operator">=</span> []<br><span class="hljs-keyword">for</span> integer <span class="hljs-keyword">in</span> [<span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">23</span>, <span class="hljs-number">42</span>] &#123;<br>    <span class="hljs-keyword">if</span> integer <span class="hljs-operator">%</span> <span class="hljs-number">2</span> <span class="hljs-operator">==</span> <span class="hljs-number">0</span> &#123;<br>        evenNumbers(integer)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li>å¦‚æœå˜é‡ç±»å‹å¯ä»¥ä¾é æ¨æ–­å¾—å‡ºï¼Œä¸å»ºè®®å£°æ˜å˜é‡æ—¶æŒ‡æ˜ç±»å‹ã€‚</li><li>ä¸è¦ä½¿ç”¨ as! æˆ– try!ã€‚</li><li>æˆ‘ä»¬æ¨èä½¿ç”¨æå‰è¿”å›çš„ç­–ç•¥ï¼Œè€Œä¸æ˜¯ if è¯­å¥çš„åµŒå¥—ã€‚ä½¿ç”¨ guard è¯­å¥å¯ä»¥æ”¹å–„ä»£ç çš„å¯è¯»æ€§ã€‚<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-comment">// æ¨è</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">eatDoughnut</span>(<span class="hljs-params">atIndex</span> <span class="hljs-params">index</span>: <span class="hljs-type">Int</span>)</span> &#123;<br>    <span class="hljs-keyword">guard</span> index <span class="hljs-operator">&gt;=</span> <span class="hljs-number">0</span> <span class="hljs-operator">&amp;&amp;</span> index <span class="hljs-operator">&lt;</span> doughnuts <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// å¦‚æœ index è¶…å‡ºå…è®¸èŒƒå›´ï¼Œæå‰è¿”å›ã€‚</span><br>        <span class="hljs-keyword">return</span><br>    &#125;<br>    <span class="hljs-keyword">let</span> doughnut <span class="hljs-operator">=</span> doughnuts[index]<br>    eat(doughnut)<br>&#125;<br><span class="hljs-comment">// ä¸æ¨è</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">eatDoughnuts</span>(<span class="hljs-params">atIndex</span> <span class="hljs-params">index</span>: <span class="hljs-type">Int</span>)</span> &#123;<br>    <span class="hljs-keyword">if</span> index <span class="hljs-operator">&gt;=</span> <span class="hljs-number">0</span> <span class="hljs-operator">&amp;&amp;</span> index <span class="hljs-operator">&lt;</span> donuts.count &#123;<br>        <span class="hljs-keyword">let</span> doughnut <span class="hljs-operator">=</span> doughnuts[index]<br>        eat(doughnut)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="4-æ³¨é‡Šè§„èŒƒ"><a href="#4-æ³¨é‡Šè§„èŒƒ" class="headerlink" title="4.æ³¨é‡Šè§„èŒƒ"></a>4.æ³¨é‡Šè§„èŒƒ</h3><ul><li>MARKï¼Œç”¨äºæ–¹æ³•æˆ–å‡½æ•°çš„æ³¨é‡Šã€‚åŠ ä¸Š â€˜-â€™ å†å‡½æ•°åˆ—è¡¨ä¼šå¤šä¸€ä¸ªæ¨ªçº¿åˆ†å‰²<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-comment">// MARK: - æè¿°å†…å®¹</span><br><span class="hljs-comment">// MARK: æè¿°å†…å®¹</span><br></code></pre></td></tr></table></figure></li><li>TODOï¼Œè¡¨ç¤ºè¿™é‡Œä»£ç æœ‰æ²¡æœ‰å®Œæˆï¼Œè¿˜è¦å¤„ç†ã€‚åŠ ä¸Š â€˜-â€™ å†å‡½æ•°åˆ—è¡¨ä¼šå¤šä¸€ä¸ªæ¨ªçº¿åˆ†å‰²<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> - æè¿°å†…å®¹</span><br><span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> æè¿°å†…å®¹</span><br></code></pre></td></tr></table></figure></li><li>FIXMEï¼Œéœ€è¦ä¿®æ”¹ä»£ç ï¼Œbugç­‰ã€‚åŠ ä¸Š â€˜-â€™ å†å‡½æ•°åˆ—è¡¨ä¼šå¤šä¸€ä¸ªæ¨ªçº¿åˆ†å‰²ï¼Œä¸”æ˜¾ç¤ºçš„icon ä¸markå’Œtodoä¸é€šï¼Œæ›´é†’ç›®<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-comment">// <span class="hljs-doctag">FIXME:</span> - æè¿°å†…å®¹</span><br><span class="hljs-comment">// <span class="hljs-doctag">FIXME:</span> æè¿°å†…å®¹</span><br></code></pre></td></tr></table></figure></li><li>æ·»åŠ æ–‡æ¡£æ³¨é‡Šï¼ˆxcode å¿«æ·é”®âŒ˜âŒ¥/ï¼‰<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-comment">/// è·å–ç”¨æˆ·çš„å¸å¯†ä¿¡æ¯</span><br><span class="hljs-comment">///</span><br><span class="hljs-comment">/// - Returns: ä¿¡æ¯å…ƒç»„çš„ Observable</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fetchLocalInfo</span>()</span> -&gt; <span class="hljs-type">Observable</span>&lt;(<span class="hljs-type">String</span>, <span class="hljs-type">String</span>)?&gt; &#123;<br>    <span class="hljs-comment">// coding</span><br>&#125;<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Xcode æ·»åŠ  script è‡ªåŠ¨æ›´æ–° Build</title>
    <link href="/2018/11/27/runscript/"/>
    <url>/2018/11/27/runscript/</url>
    
    <content type="html"><![CDATA[<p>æ¯æ¬¡æ‰“åŒ…ç»å¸¸ä¼šé‡åˆ°å¿˜è®°ä¿®æ”¹ bulid å¯¼è‡´ä¸Šä¼ å¤±è´¥ï¼Œåˆä¸å¾—ä¸é‡æ–°æ‰“åŒ…ä¸Šä¼ ï¼Œæå…¶æµªè´¹æ—¶é—´ã€‚<br>xcode çš„ Build Phases çš„run script å¯ä»¥æ·»åŠ è„šæœ¬ï¼Œæ¥è‡ªåŠ¨æ›´æ–°buildçš„å€¼</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Bash">git=`sh /etc/profile; <span class="hljs-built_in">which</span> git`<br>appBuild=`<span class="hljs-string">&quot;<span class="hljs-variable">$git</span>&quot;</span> rev-list --all |wc -l`<br><br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$CONFIGURATION</span> = <span class="hljs-string">&quot;Debug&quot;</span> ]; <span class="hljs-keyword">then</span><br>branchName=`<span class="hljs-string">&quot;<span class="hljs-variable">$git</span>&quot;</span> rev-parse --abbrev-ref HEAD`<br>branchShort=`<span class="hljs-string">&quot;<span class="hljs-variable">$git</span>&quot;</span> rev-parse --abbrev-short HEAD`<br>/usr/libexec/PlistBuddy -c <span class="hljs-string">&quot;Set :BranchName <span class="hljs-variable">$branchName</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;TARGET_BUILD_DIR&#125;</span>/<span class="hljs-variable">$&#123;INFOPLIST_PATH&#125;</span>&quot;</span><br>/usr/libexec/PlistBuddy -c <span class="hljs-string">&quot;Set :BranchShort <span class="hljs-variable">$branchShort</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;TARGET_BUILD_DIR&#125;</span>/<span class="hljs-variable">$&#123;INFOPLIST_PATH&#125;</span>&quot;</span><br>/usr/libexec/PlistBuddy -c <span class="hljs-string">&quot;Set :APPBuildNum <span class="hljs-variable">$appBuild</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;TARGET_BUILD_DIR&#125;</span>/<span class="hljs-variable">$&#123;INFOPLIST_PATH&#125;</span>&quot;</span><br><span class="hljs-keyword">else</span><br>/usr/libexec/PlistBuddy -c <span class="hljs-string">&quot;Set :CFBundleVersion <span class="hljs-variable">$appBuild</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;TARGET_BUILD_DIR&#125;</span>/<span class="hljs-variable">$&#123;INFOPLIST_PATH&#125;</span>&quot;</span><br><span class="hljs-keyword">fi</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Updated <span class="hljs-variable">$&#123;TARGET_BUILD_DIR&#125;</span>/<span class="hljs-variable">$&#123;INFOPLIST_PATH&#125;</span>&quot;</span><br></code></pre></td></tr></table></figure><p>å…¶ä¸­  <strong>BranchName</strong>ã€<strong>BranchShort</strong>ã€<strong>APPBuildNum</strong>ã€<strong>CFBundleVersion</strong>ï¼Œå‰ä¸‰ä¸ªéœ€è¦åœ¨info.plist æ–°å¢å­—æ®µ<br>ä¹Ÿå¯ä»¥æ ¹æ®éœ€æ±‚è‡ªå®šä¹‰å…¶ä»–å­—æ®µã€‚<br>è¿™é‡Œæ ¹æ® debug å’Œ release åšäº†åŒºåˆ†ã€‚<br>DEBUGï¼š å¯ä»¥æ‹¿åˆ° åˆ†æ”¯åå­—ã€ åˆ†æ”¯commitIDã€buildæ¬¡æ•°<br>RELEASEï¼šå¯ä»¥æ‹¿åˆ°build æ¬¡æ•°</p><p>psï¼šç›®å‰ï¼Œåœ¨å¤štargetç‰ˆæœ¬è¿˜æœ‰ç‚¹é—®é¢˜ï¼Œåœ¨æœ€åˆçš„targeté‡Œæ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯åœ¨copyå‡ºæ¥çš„å…¶ä»–targetæš‚æ—¶æ— æ³•è¿è¡Œ</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å¤š Target æ¥è¿›è¡Œ ç‰ˆæœ¬orç¯å¢ƒ åŒºåˆ†</title>
    <link href="/2018/11/26/mul-target/"/>
    <url>/2018/11/26/mul-target/</url>
    
    <content type="html"><![CDATA[<p>æœ‰æ—¶å€™é¡¹ç›®å¯¹äºç¯å¢ƒçš„åˆ‡æ¢æˆ–è€…æ˜¯åŒä¸€å¥—ä»£ç ä¸åŒçš„appçš„åˆ‡æ¢ï¼Œæ¯æ¬¡æ‰‹åŠ¨æ”¹ä»£ç å¾ˆä¸æ–¹ä¾¿ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚<br>xcode å¯ä»¥æ·»åŠ  Target æ¥éå¸¸æ–¹ä¾¿çš„è¿›è¡Œåˆ‡æ¢</p><h3 id="æ·»åŠ -Target-æ­¥éª¤"><a href="#æ·»åŠ -Target-æ­¥éª¤" class="headerlink" title="æ·»åŠ  Target æ­¥éª¤"></a>æ·»åŠ  Target æ­¥éª¤</h3><ul><li>åœ¨é¡¹ç›®è®¾ç½®é¡µé¢ï¼Œåœ¨ TARGETS ä¸‹åˆ—è¡¨ä¸­ï¼Œé€‰æ‹©éœ€è¦å¤åˆ¶çš„target å³é”®ï¼Œé€‰Duplicateï¼Œå†é€‰ Duplicate only</li><li>ç„¶åTargets ä¸‹ä¼šæ–°å¢ä¸€ä¸ª <strong>â€˜xxx copyâ€™</strong> çš„targetï¼Œé€‰ä¸­å å•å‡»å¯æ”¹å</li><li>å¹¶ä¸”ä¼šå¤šäº†ä¸€ä¸ª  <strong>â€˜xxx copy-info.plistâ€™</strong> æ–‡ä»¶</li><li>å¯ä»¥ç‚¹å‡»target é…ç½®ä¸é€šçš„app nameã€bundleIDã€icon ç­‰ç­‰å…¶ä»–ç›¸å…³é…ç½®</li></ul><h3 id="Target-åŒºåˆ†é…ç½®"><a href="#Target-åŒºåˆ†é…ç½®" class="headerlink" title="Target åŒºåˆ†é…ç½®"></a>Target åŒºåˆ†é…ç½®</h3><ul><li>åœ¨å¯¹åº”çš„ target çš„ buildsetting ä¸‹æ‰¾åˆ° Preprocessor Macros, è¯¥é€‰æ‹©ä¸‹é¢æœ‰ä¸ªå€¼ Debug å’Œ Releaseã€‚åœ¨å…¶ä¸­ Debug or Release é‡Œé¢æ·»åŠ  æŸä¸ªå‚æ•°=1ï¼Œä¾‹å¦‚ï¼šåœ¨DEBUG é‡Œé¢ æ·»åŠ  DEBUG=1ã€‚é‚£ä¹ˆåœ¨schemeé‡Œé¢è®¾ç½® build configuration è®¾ç½®ä¸º debugæ—¶ï¼ŒDEBUG çš„å€¼å³ä¸ºtrueï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥ç”¨æ¥åˆ‡æ¢çº¿ä¸Šçº¿ä¸‹ç¯å¢ƒ<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">#if</span> <span class="hljs-type">DEBUG</span><br><span class="hljs-comment">// æµ‹è¯•ç¯å¢ƒ</span><br><span class="hljs-keyword">#else</span><br><span class="hljs-comment">// çº¿ä¸Šç¯å¢ƒ</span><br><span class="hljs-keyword">#endif</span><br></code></pre></td></tr></table></figure></li><li>åœ¨buildsetting ä¸‹çš„Other Swift flags ä¸‹ä¹Ÿå¯æ·»åŠ æ ‡è¯†ç¬¦ ï¼Œåœ¨debug å’Œrelease ä¸‹æ·»åŠ å³ä¸ºtrueã€‚<br>ä¾‹å¦‚ å¦‚æœåœ¨æ–°targetä¸‹çš„ debugä¸‹æ·»åŠ  -DDEBUGï¼Œ åˆ™DEBUGä¸ºtrueï¼Œdebug releaseå‡æ·»åŠ  -DNEWï¼Œåˆ™ä¸è®ºdebugè¿˜æ˜¯releaseæ¨¡å¼ä¸‹ï¼Œ NEWå‡ä¸ºtrueï¼Œè¿™æ ·å°±å¯ä»¥åŒºåˆ†ä¸åŒçš„targetçš„é…ç½®ä¸€äº›<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">#if</span> <span class="hljs-type">NEW</span><br><span class="hljs-comment">// NEW target</span><br><span class="hljs-keyword">#else</span><br><span class="hljs-comment">// é NEW target</span><br><span class="hljs-keyword">#endif</span><br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>iOSæé«˜é¡µé¢ä¹¦å†™æ•ˆç‡</title>
    <link href="/2018/11/24/ui-layout/"/>
    <url>/2018/11/24/ui-layout/</url>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰çš„é¡¹ç›®ç”¨äº†çš„RXSwift å’Œ RxCocoaï¼Œç°åœ¨ç»“åˆRxCocoa åšä¸€äº›åŠ¨æ€å¸ƒå±€çš„ä¼˜åŒ–ã€‚</p><h3 id="ä¸€ã€å®ç°ç±»ä¼¼H5çš„æµå¼å¸ƒå±€"><a href="#ä¸€ã€å®ç°ç±»ä¼¼H5çš„æµå¼å¸ƒå±€" class="headerlink" title="ä¸€ã€å®ç°ç±»ä¼¼H5çš„æµå¼å¸ƒå±€"></a>ä¸€ã€å®ç°ç±»ä¼¼H5çš„æµå¼å¸ƒå±€</h3><p>å¦‚æœäº†è§£H5çš„åº”è¯¥éƒ½çŸ¥é“å®ƒçš„æµå¼å¸ƒå±€éå¸¸æ–¹ä¾¿ï¼Œä¸éœ€è¦è€ƒè™‘ä¸Šä¸‹å…ƒç´ çš„å…³ç³»ã€‚<br>iOSçš„å¸ƒå±€å…¶å®ç±»ä¼¼H5çš„ç»å¯¹å¸ƒå±€ï¼Œä½†æ¯æ¯è¦å†™æ¸…æ¥šä¸Šä¸‹å…ƒç´ ä¹‹é—´çš„å…³ç³»ï¼Œè€Œä¸”æ¯å½“é¡µé¢æœ‰å…ƒç´ å¢åˆ çš„æ—¶å€™åˆè¦å»ä¿®æ”¹ç›¸å…³çš„çº¦æŸã€‚</p><p>ç°åœ¨ä¸€ä¸ªæ›¿ä»£æ€è·¯å°±æ˜¯å†™ä¸€ä¸ªé€šç”¨çš„å‡½æ•°ï¼Œç»™å®šå…ƒç´ çš„æ•°ç»„ï¼Œçˆ¶viewç­‰å‚æ•°ï¼Œå‡½æ•°å†…éƒ¨æ‰§è¡Œæ·»åŠ ç›¸å…³çº¦æŸã€‚é¿å…æ¯æ¬¡éƒ½è¦å†™çº¦æŸä»¥åŠæ”¹åŠ¨</p><h3 id="äºŒã€ç‚¹å‡»åŠŸèƒ½çš„æŒ‰é’®çš„çŠ¶æ€åˆ‡æ¢"><a href="#äºŒã€ç‚¹å‡»åŠŸèƒ½çš„æŒ‰é’®çš„çŠ¶æ€åˆ‡æ¢" class="headerlink" title="äºŒã€ç‚¹å‡»åŠŸèƒ½çš„æŒ‰é’®çš„çŠ¶æ€åˆ‡æ¢"></a>äºŒã€ç‚¹å‡»åŠŸèƒ½çš„æŒ‰é’®çš„çŠ¶æ€åˆ‡æ¢</h3><p>åœ¨å†™æŸäº›æŒ‰é’®çš„æ—¶å€™ï¼Œé€‰æ‹©çŠ¶æ€ å’Œ éé€‰æ‹©çŠ¶æ€ æ ·å¼å·®å¼‚æ¯”è¾ƒå¤§ï¼Œbtnè‡ªå¸¦çš„é‚£äº›çŠ¶æ€ ä¸èƒ½å¤Ÿæ»¡è¶³æ¡ä»¶ã€‚<br>æœ‰æ—¶å€™åªèƒ½æ ¹æ®ä¸Šå±‚ä¼ æ¥çš„æ–¹æ³•å†å»åšç›¸åº”çš„ä¿®æ”¹ã€‚<br>ä½†æ˜¯è¿™æ ·ä¹Ÿå†™ä»£ç å°±ä¸æ˜¯èˆ’æœï¼Œå¯ä»¥ç»“åˆrxswift ï¼Œç»§æ‰¿btn,æ·»åŠ å‡ ä¸ªå±æ€§ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">lazy</span> <span class="hljs-keyword">var</span> disposeBag <span class="hljs-operator">=</span> <span class="hljs-type">DisposeBag</span>()<br><span class="hljs-keyword">typealias</span> <span class="hljs-type">Block</span> <span class="hljs-operator">=</span> (<span class="hljs-type">STATButton</span>) -&gt; ()<br><span class="hljs-keyword">var</span> stat <span class="hljs-operator">=</span> <span class="hljs-type">BehaviorRelay</span>&lt;<span class="hljs-type">Bool</span>&gt;(value: <span class="hljs-literal">false</span>)<br><span class="hljs-keyword">var</span> trueSB: <span class="hljs-type">Block</span>?<br><span class="hljs-keyword">var</span> falseSB: <span class="hljs-type">Block</span>?<br></code></pre></td></tr></table></figure><p>ç„¶åå†init é‡Œé¢è®¢é˜… statï¼Œåç»­ä¼šå¯¹stat</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Swift">stat.skip(<span class="hljs-number">1</span>).asObservable().subscribe(onNext: &#123; [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] status <span class="hljs-keyword">in</span><br>  <span class="hljs-keyword">let</span> block <span class="hljs-operator">=</span> status <span class="hljs-operator">?</span> <span class="hljs-keyword">self</span><span class="hljs-operator">?</span>.trueSB : <span class="hljs-keyword">self</span><span class="hljs-operator">?</span>.falseSB<br>  <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> b <span class="hljs-operator">=</span> block &#123;<br>    b(<span class="hljs-keyword">self</span><span class="hljs-operator">!</span>)<br>  &#125;<br>&#125;).disposed(by: disposeBag)<br></code></pre></td></tr></table></figure><p>åœ¨å†™æ ·å¼çš„æ—¶å€™å¯ä»¥å§é€‰æ‹©å’Œéé€‰æ‹©çŠ¶æ€ä¸€èµ·å†™äº†</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs Swift">likeBtn.trueSB <span class="hljs-operator">=</span> &#123; btn <span class="hljs-keyword">in</span><br>    btn.setImage(<span class="hljs-type">UIImage</span>(named: <span class="hljs-string">&quot;zan_full.png&quot;</span>), for: .normal)<br>    btn.setTitle(<span class="hljs-string">&quot;å·²èµ&quot;</span>, for: .normal)<br>&#125;<br>likeBtn.falseSB <span class="hljs-operator">=</span> &#123; btn <span class="hljs-keyword">in</span><br>    btn.setImage(<span class="hljs-type">UIImage</span>(named: <span class="hljs-string">&quot;zan.png&quot;</span>), for: .normal)<br>    btn.setTitle(<span class="hljs-string">&quot;èµ&quot;</span>, for: .normal)<br>&#125;<br></code></pre></td></tr></table></figure><p>å†èµ‹å€¼çš„æ—¶å€™å°±ä¸ç”¨å†å…³å¿ƒæ ·å¼çš„é—®é¢˜ï¼Œåªéœ€è¦ç»™statå±æ€§èµ‹ä¸€ä¸ªtrue or false</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Swift">likeBtn.stat.accept(<span class="hljs-literal">true</span>)<br></code></pre></td></tr></table></figure><p>åŒæ ·çš„ UIView UIImageView éƒ½å¯ä»¥ç±»ä¼¼æ“ä½œ</p><h3 id="ä¸‰ã€éƒ¨åˆ†å…ƒç´ æ ¹æ®æ•°æ®æ˜¯å¦æ˜¾ç¤ºå¯¹ä¸Šä¸‹å…ƒç´ çš„å½±å“"><a href="#ä¸‰ã€éƒ¨åˆ†å…ƒç´ æ ¹æ®æ•°æ®æ˜¯å¦æ˜¾ç¤ºå¯¹ä¸Šä¸‹å…ƒç´ çš„å½±å“" class="headerlink" title="ä¸‰ã€éƒ¨åˆ†å…ƒç´ æ ¹æ®æ•°æ®æ˜¯å¦æ˜¾ç¤ºå¯¹ä¸Šä¸‹å…ƒç´ çš„å½±å“"></a>ä¸‰ã€éƒ¨åˆ†å…ƒç´ æ ¹æ®æ•°æ®æ˜¯å¦æ˜¾ç¤ºå¯¹ä¸Šä¸‹å…ƒç´ çš„å½±å“</h3><p>ä¾‹å¦‚åœ¨å†™ç”¨æˆ·è¯„è®ºå“ªä¸€å—ï¼Œç±»ä¼¼æœ‹å‹åœˆã€‚<br>æ ¹æ®æ•°æ®ï¼Œç‚¹èµã€è¯„è®ºã€å›¾ç‰‡ç­‰å…ƒç´ å¯èƒ½æœ‰å¯èƒ½æ²¡æœ‰ï¼Œè¿˜è¦è€ƒè™‘å„ä¸ªå…ƒç´ é—´çš„è·ç¦»</p><p>ç›®å‰è§£å†³åŠæ³•ä¹Ÿå’Œç¬¬äºŒæ¡ä¸€æ ·ï¼Œåœ¨å†™çº¦æŸçš„æ—¶å€™ï¼Œå†™åœ¨trueSB å’Œ falseSB é‡Œé¢</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Swift">heart.trueSB <span class="hljs-operator">=</span> &#123; [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] v <span class="hljs-keyword">in</span><br>  v.snp.remakeConstraints &#123; make <span class="hljs-keyword">in</span><br>    make.left.equalTo(<span class="hljs-type">ContentEdge</span>.left)<br>    make.top.equalTo(<span class="hljs-keyword">self</span><span class="hljs-operator">!</span>.content.snp.bottom).offset(<span class="hljs-number">10</span>)<br>  &#125;<br>&#125;<br>heart.falseSB <span class="hljs-operator">=</span> &#123; [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] v <span class="hljs-keyword">in</span><br>  v.snp.remakeConstraints &#123; make <span class="hljs-keyword">in</span><br>    make.left.equalTo(<span class="hljs-type">ContentEdge</span>.left)<br>    make.height.equalTo(<span class="hljs-number">0</span>)<br>    make.top.equalTo(<span class="hljs-keyword">self</span><span class="hljs-operator">!</span>.content.snp.bottom).offset(<span class="hljs-number">0</span>)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åé¢ä¸¤æ¡ä¸»è¦æ˜¯è®©æ ·å¼ä»£ç å’Œé€»è¾‘ä»£ç ï¼Œæ›´åŠ é«˜èšåˆä½è€¦åˆ</p><p>ps: å…¶å®ä¹Ÿå¯ä»¥é€šè¿‡å†™ä¸€ä¸ªsetæ–¹æ³•æ¥è°ƒç”¨blockï¼Œè¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼Œä¸å¿…ä½¿ç”¨rxcocoa</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>runloop</title>
    <link href="/2018/09/20/runloop/"/>
    <url>/2018/09/20/runloop/</url>
    
    <content type="html"><![CDATA[<h3 id="runloopç›¸å…³çš„åº”ç”¨"><a href="#runloopç›¸å…³çš„åº”ç”¨" class="headerlink" title="runloopç›¸å…³çš„åº”ç”¨"></a>runloopç›¸å…³çš„åº”ç”¨</h3><h4 id="æ»‘åŠ¨åˆ—è¡¨çš„ä¼˜åŒ–"><a href="#æ»‘åŠ¨åˆ—è¡¨çš„ä¼˜åŒ–" class="headerlink" title="æ»‘åŠ¨åˆ—è¡¨çš„ä¼˜åŒ–"></a>æ»‘åŠ¨åˆ—è¡¨çš„ä¼˜åŒ–</h4><p>cellä¸­è®¾ç½®å›¾ç‰‡ ä¼šå¡é¡¿ä»¥ä¸‹ï¼Œå¯ä»¥å§è®¾ç½®imageçš„ä»£ç æ”¾ç½®åœ¨runloop default çš„modeé‡Œè¿è¡Œã€‚<br>é¿å…æ»‘åŠ¨çš„è¿‡ç¨‹ä¸­å»è§¦å‘è®¾ç½®imageçš„åŠ¨ä½œã€‚</p><h4 id="app-Crash-çš„ä¼˜åŒ–"><a href="#app-Crash-çš„ä¼˜åŒ–" class="headerlink" title="app Crash çš„ä¼˜åŒ–"></a>app Crash çš„ä¼˜åŒ–</h4><p>crashå å¯ä»¥é‡æ–°å”¤é†’ä¸€ä¸ªapp åšä¸€äº›æç¤ºæ€§çš„æ–‡å­— å‘é€æŠ¥é”™é‚®ä»¶ç­‰</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>RXSwift</title>
    <link href="/2018/09/14/rxswift/"/>
    <url>/2018/09/14/rxswift/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘æ–°çš„é¡¹ç›®é‡‡ç”¨äº†rxswift + mvvm æ¥å†™ã€‚<br>ç½‘ç»œæ¡†æ¶ç”¨çš„moya çš„rxswiftç‰ˆã€‚</p><p>æ€»çš„ä½“éªŒæ¥è¯´ï¼Œmvvmæ¶æ„ä¸­ï¼Œç¡®å®šä½“ä¼šåˆ°äº†æŠŠæ•°æ®é€»è¾‘å‰¥ç¦»å‡ºæ¥å¹¶ä¸”æ–¹ä¾¿å¤ç”¨çš„ä¾¿åˆ©ã€‚<br>é‡‡ç”¨äº†å“åº”å¼ç¼–ç¨‹ç†å¿µï¼Œç”¨äº†rxswiftã€‚åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œrxswift çš„ä½“éªŒéå¸¸å¥½.<br>ä¸è¿‡ç°åœ¨ä¹Ÿé€ æˆäº†åœ¨é—®é¢˜è¿½è¸ªä¸Šä¼šæ¯”è¾ƒéº»çƒ¦ã€‚</p><p>è¿™å‡ ä¸ªæœˆå½“ä¸­ä¹Ÿæ˜¯è¸©äº†ä¸å°‘å‘ï¼Œç»“åˆå®é™…å¼€å‘ç®€å•è¯´è¯´rxswiftçš„ä¸€äº›å®é™…è¿ç”¨ã€‚</p><h3 id="å®é™…åº”ç”¨å½“ä¸­çš„ä¸€äº›ä½¿ç”¨åœºæ™¯"><a href="#å®é™…åº”ç”¨å½“ä¸­çš„ä¸€äº›ä½¿ç”¨åœºæ™¯" class="headerlink" title="å®é™…åº”ç”¨å½“ä¸­çš„ä¸€äº›ä½¿ç”¨åœºæ™¯"></a>å®é™…åº”ç”¨å½“ä¸­çš„ä¸€äº›ä½¿ç”¨åœºæ™¯</h3><h4 id="1-ç®€åŒ–tableviewç­‰æ•°æ®ç»‘å®šæµç¨‹"><a href="#1-ç®€åŒ–tableviewç­‰æ•°æ®ç»‘å®šæµç¨‹" class="headerlink" title="1. ç®€åŒ–tableviewç­‰æ•°æ®ç»‘å®šæµç¨‹"></a>1. ç®€åŒ–tableviewç­‰æ•°æ®ç»‘å®šæµç¨‹</h4><p>ç»“åˆ RXDataSource ç®€åŒ– tableviewã€collectionview ç­‰çš„æ•°æ®ç»‘å®š</p><h4 id="2-ç®€åŒ–å¤æ‚é¡µé¢å¤šçŠ¶æ€é—´çš„é€»è¾‘"><a href="#2-ç®€åŒ–å¤æ‚é¡µé¢å¤šçŠ¶æ€é—´çš„é€»è¾‘" class="headerlink" title="2. ç®€åŒ–å¤æ‚é¡µé¢å¤šçŠ¶æ€é—´çš„é€»è¾‘"></a>2. ç®€åŒ–å¤æ‚é¡µé¢å¤šçŠ¶æ€é—´çš„é€»è¾‘</h4><p>ç±»ä¼¼ç™»å½•ã€è´­ç‰©è½¦ç­‰è¿™äº›å¤šä¸ªçŠ¶æ€äº’ç›¸ä¹‹é—´å½±å“çš„ï¼Œä½¿ç”¨ rxswift ä¼šæå¤§çš„ç®€åŒ–é€»è¾‘æµç¨‹ã€‚</p><h4 id="3-åŒæ­¥çŠ¶æ€ä¿¡æ¯"><a href="#3-åŒæ­¥çŠ¶æ€ä¿¡æ¯" class="headerlink" title="3. åŒæ­¥çŠ¶æ€ä¿¡æ¯"></a>3. åŒæ­¥çŠ¶æ€ä¿¡æ¯</h4><p>ç±»ä¼¼å¾ˆå¤šé¡µé¢å‡ºç°ç›¸åŒçš„æ•°æ®åˆ—è¡¨ï¼Œåˆ—è¡¨è¿˜ä¼šå±•ç¤ºçŠ¶æ€ä¿¡æ¯ï¼Œæ¯”å¦‚ç‚¹èµã€æ”¶è—ç­‰ã€‚<br>è¿™äº›çŠ¶æ€ä¿¡æ¯åŒæ­¥å¯ä»¥é€šè¿‡å‘é€äº‹ä»¶ï¼Œåœ¨æ‰€æœ‰ç›¸å…³åˆ—è¡¨è®¢é˜…è¿™ä¸ªäº‹ä»¶ï¼Œç„¶åå¤„ç†æ”¹å˜å„è‡ªåˆ—è¡¨çš„çŠ¶æ€</p><h3 id="rxswiftå­¦ä¹ ç¬”è®°"><a href="#rxswiftå­¦ä¹ ç¬”è®°" class="headerlink" title="rxswiftå­¦ä¹ ç¬”è®°"></a>rxswiftå­¦ä¹ ç¬”è®°</h3><p>å†™çš„å¹¶ä¸å…¨ï¼Œä¸»è¦æ˜¯å¯¹ä¸€äº›å¸¸ç”¨çš„åœ°æ–¹åšä¸ªç®€å•çš„è®°å½•</p><h4 id="1-share-replay-scope"><a href="#1-share-replay-scope" class="headerlink" title="1. share(replay:scope:)"></a>1. <strong>share(replay:scope:)</strong></h4><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå¯¹Observer è¿›è¡Œå¤šæ¬¡è®¢é˜…ï¼Œå¦‚ä¸‹</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">var</span> ob <span class="hljs-operator">=</span> <span class="hljs-type">Observable</span>.of(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>).map &#123; <span class="hljs-built_in">print</span>(<span class="hljs-variable">$0</span>) &#125;.share(replay: <span class="hljs-number">1</span>, scope: .forever)<br>ob.subscribe(onNext: &#123; res <span class="hljs-keyword">in</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;first sub&quot;</span>)<br>&#125;)<br><br>ob.subscribe(onNext: &#123; res <span class="hljs-keyword">in</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;second sub&quot;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼Œå¤šæ¬¡è®¢é˜…ä¼šå°†æ•´ä¸ªé“¾å¼å¤šæ¬¡æ‰§è¡Œï¼Œä½†å¤§å¤šæ•°æƒ…å†µä¸‹åªå¸Œæœ›map åªæ‰§è¡Œä¸€æ¬¡ï¼Œæ¯”å¦‚mapé‡Œé¢å¯èƒ½æ˜¯ç½‘ç»œè¯·æ±‚ç­‰ç­‰ã€‚</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-number">1</span><br><span class="hljs-keyword">first</span> sub<br><span class="hljs-number">1</span><br><span class="hljs-keyword">second</span> sub<br></code></pre></td></tr></table></figure><p>å¯ä»¥åœ¨mapåé¢æ·»åŠ share</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">var</span> ob <span class="hljs-operator">=</span> <span class="hljs-type">Observable</span>.of(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>).map &#123; <span class="hljs-built_in">print</span>(<span class="hljs-variable">$0</span>) &#125;.share(replay: <span class="hljs-number">1</span>, scope: .forever)<br></code></pre></td></tr></table></figure><p>ç°åœ¨é“¾å¼åªæ‰§è¡Œäº†ä¸€æ¬¡</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-number">1</span><br><span class="hljs-keyword">first</span> sub<br><span class="hljs-keyword">second</span> sub<br></code></pre></td></tr></table></figure><h4 id="2-retry"><a href="#2-retry" class="headerlink" title="2. retry"></a>2. <strong>retry</strong></h4><p>å½“é‡åˆ°error æ—¶ï¼Œä¼šé‡æ–°è®¢é˜…è¯¥åºåˆ—<br>retry(2)é‡Œé¢æ•°å­—ä»£è¡¨é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤1æ¬¡</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs axapta"><span class="hljs-built_in">enum</span> MyError: Error &#123;<br>    <span class="hljs-keyword">case</span> A<br>    <span class="hljs-keyword">case</span> B<br>&#125;<br><br><span class="hljs-built_in">var</span> <span class="hljs-keyword">count</span> = <span class="hljs-number">1</span><br>let sequenceThatErrors = Observable&lt;String&gt;.create &#123; observer <span class="hljs-keyword">in</span><br>    observer.onNext(<span class="hljs-string">&quot;a&quot;</span>)<br>    observer.onNext(<span class="hljs-string">&quot;b&quot;</span>)<br><br>    <span class="hljs-comment">//è®©ç¬¬ä¸€ä¸ªè®¢é˜…æ—¶å‘ç”Ÿé”™è¯¯</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">count</span> == <span class="hljs-number">1</span> &#123;<br>        observer.onError(MyError.A)<br>        <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;Error encountered&quot;</span>)<br>        <span class="hljs-keyword">count</span> += <span class="hljs-number">1</span><br>    &#125;<br><br>    observer.onNext(<span class="hljs-string">&quot;c&quot;</span>)<br>    observer.onNext(<span class="hljs-string">&quot;d&quot;</span>)<br>    observer.onCompleted()<br><br>    <span class="hljs-keyword">return</span> Disposables.create()<br>&#125;<br><br>sequenceThatErrors<br>    .<span class="hljs-keyword">retry</span>(<span class="hljs-number">2</span>)  <span class="hljs-comment">//é‡è¯•2æ¬¡ï¼ˆå‚æ•°ä¸ºç©ºåˆ™åªé‡è¯•ä¸€æ¬¡ï¼‰</span><br>    .subscribe(onNext: &#123; <span class="hljs-keyword">print</span>($<span class="hljs-number">0</span>) &#125;)<br><br></code></pre></td></tr></table></figure><h4 id="3-debug"><a href="#3-debug" class="headerlink" title="3. debug"></a>3. <strong>debug</strong></h4><p>å¯ä»¥æ‰“å°ç›¸å…³ä¿¡æ¯ï¼Œæ–¹ä¾¿è°ƒè¯•<br>å¤šä¸ªdebugæ—¶ï¼Œæ·»åŠ å­—ç¬¦ä¸²äºˆä»¥åŒºåˆ†ï¼šdebug(â€œè°ƒè¯•â€)</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">var</span> ob <span class="hljs-operator">=</span> <span class="hljs-type">Observable</span>.of(<span class="hljs-number">1</span>).map &#123; <span class="hljs-built_in">print</span>(<span class="hljs-variable">$0</span>) &#125;.share(replay: <span class="hljs-number">1</span>, scope: .forever                    )<br>ob.debug(<span class="hljs-string">&quot;frist&quot;</span>).subscribe(onNext: &#123; res <span class="hljs-keyword">in</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;first sub&quot;</span>)<br>&#125;)<br><br>ob.debug(<span class="hljs-string">&quot;second&quot;</span>).subscribe(onNext: &#123; res <span class="hljs-keyword">in</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;second sub&quot;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><p>æ‰“å°ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2018</span>-<span class="hljs-number">12</span>-<span class="hljs-number">24</span> <span class="hljs-number">15</span>:<span class="hljs-number">07</span>:<span class="hljs-number">29</span>.<span class="hljs-number">612</span>: frist -&gt; subscribed<br><span class="hljs-attribute">1</span><br><span class="hljs-attribute">2018</span>-<span class="hljs-number">12</span>-<span class="hljs-number">24</span> <span class="hljs-number">15</span>:<span class="hljs-number">07</span>:<span class="hljs-number">29</span>.<span class="hljs-number">614</span>: frist -&gt; Event next(())<br><span class="hljs-attribute">first</span> sub<br><span class="hljs-attribute">2018</span>-<span class="hljs-number">12</span>-<span class="hljs-number">24</span> <span class="hljs-number">15</span>:<span class="hljs-number">07</span>:<span class="hljs-number">29</span>.<span class="hljs-number">614</span>: frist -&gt; Event completed<br><span class="hljs-attribute">2018</span>-<span class="hljs-number">12</span>-<span class="hljs-number">24</span> <span class="hljs-number">15</span>:<span class="hljs-number">07</span>:<span class="hljs-number">29</span>.<span class="hljs-number">614</span>: frist -&gt; isDisposed<br><span class="hljs-attribute">2018</span>-<span class="hljs-number">12</span>-<span class="hljs-number">24</span> <span class="hljs-number">15</span>:<span class="hljs-number">07</span>:<span class="hljs-number">29</span>.<span class="hljs-number">655</span>: second -&gt; subscribed<br><span class="hljs-attribute">2018</span>-<span class="hljs-number">12</span>-<span class="hljs-number">24</span> <span class="hljs-number">15</span>:<span class="hljs-number">07</span>:<span class="hljs-number">29</span>.<span class="hljs-number">656</span>: second -&gt; Event next(())<br><span class="hljs-attribute">second</span> sub<br><span class="hljs-attribute">2018</span>-<span class="hljs-number">12</span>-<span class="hljs-number">24</span> <span class="hljs-number">15</span>:<span class="hljs-number">07</span>:<span class="hljs-number">29</span>.<span class="hljs-number">656</span>: second -&gt; Event completed<br><span class="hljs-attribute">2018</span>-<span class="hljs-number">12</span>-<span class="hljs-number">24</span> <span class="hljs-number">15</span>:<span class="hljs-number">07</span>:<span class="hljs-number">29</span>.<span class="hljs-number">656</span>: second -&gt; isDisposed<br></code></pre></td></tr></table></figure><h4 id="4-Single"><a href="#4-Single" class="headerlink" title="4. Single"></a>4. <strong>Single</strong></h4><p>Single æ˜¯ Observable çš„å¦å¤–ä¸€ä¸ªç‰ˆæœ¬ã€‚ä½†å®ƒä¸åƒ Observable å¯ä»¥å‘å‡ºå¤šä¸ªå…ƒç´ ï¼Œå®ƒè¦ä¹ˆåªèƒ½å‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œè¦ä¹ˆäº§ç”Ÿä¸€ä¸ª error äº‹ä»¶ã€‚</p><ul><li>å‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œæˆ–ä¸€ä¸ª error äº‹ä»¶</li><li>ä¸ä¼šå…±äº«çŠ¶æ€å˜åŒ–</li></ul><h4 id="5-Subjects"><a href="#5-Subjects" class="headerlink" title="5. Subjects"></a>5. <strong>Subjects</strong></h4><p>subjects å³æ˜¯ Observerï¼Œä¹Ÿæ˜¯ Observableã€‚å®ƒå¯ä»¥åŠ¨æ€æ¥å—æ–°çš„å€¼ï¼Œç„¶åé€šè¿‡ Event å°†æ–°å€¼å‘é€ç»™æ‰€æœ‰çš„è®¢é˜…è€…</p><p>subjects ä¸€å…±æœ‰å››ç§ï¼šPublishSubjectã€BehaviorSubjectã€ReplaySubjectã€Variable<br>å…±åŒç‚¹ï¼š</p><ul><li>ä¸€æ—¦å‘é€ .complete or .error äº‹ä»¶ï¼Œè¯¥subject å°†ç»ˆç»“ï¼Œä¸å†å‘é€ .next äº‹ä»¶</li><li>å¯¹äºåœ¨ç»ˆç»“åè®¢é˜…è¯¥sunject çš„è®¢é˜…è€…ï¼Œä¹Ÿä¼šæ”¶åˆ°ä¸€æ¡.complete or .errorï¼Œå‘Šè¯‰æ–°çš„è®¢é˜…è€…å·²ç»ç»ˆç»“äº†<br>åŒºåˆ«ï¼š</li><li>æœ€å¤§çš„åŒºåˆ«åœ¨äºæ–°çš„è®¢é˜…è€…èƒ½ä¸èƒ½æ”¶åˆ°æ—§çš„eventï¼Œèƒ½çš„è¯èƒ½æ”¶åˆ°å¤šå°‘ä¸ªã€‚</li></ul><ol><li><strong>PublishSubject</strong></li></ol><ul><li>æœ€æ™®é€šçš„subjectï¼Œä¸éœ€è¦åˆå§‹å€¼å°±èƒ½åˆ›å»º</li><li>åªèƒ½æ”¶åˆ°è®¢é˜…ä¹‹åçš„eventï¼Œæ— æ³•æ”¶åˆ°æ—§çš„ event</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">let</span> s <span class="hljs-operator">=</span> <span class="hljs-type">PublishSubject</span>&lt;<span class="hljs-type">String</span>&gt;()<br>s.onNext(<span class="hljs-string">&quot;first&quot;</span>)<br>s.subscribe(onNext: &#123; s <span class="hljs-keyword">in</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;sub <span class="hljs-subst">\(s)</span>&quot;</span>)<br>&#125;).disposed(by: disposeBag)<br>s.onNext(<span class="hljs-string">&quot;second&quot;</span>)<br></code></pre></td></tr></table></figure><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">sub <span class="hljs-keyword">second</span><br></code></pre></td></tr></table></figure><ol start="2"><li><strong>BehaviorSubject</strong></li></ol><ul><li>éœ€è¦ä¸€ä¸ªåˆå§‹å€¼æ¥åˆ›å»º</li><li>ä¸€ä¸ªæ–°çš„è®¢é˜…è€…ä¼šç«‹åˆ»æ”¶åˆ°ä¸Šä¸€ä¸ªeventï¼Œä¹‹åç…§å¸¸</li></ul><ol start="3"><li><strong>ReplaySubject</strong></li></ol><ul><li>åˆ›å»ºçš„æ—¶å€™éœ€è¦è®¾ç½®ä¸€é¢bufferSizeï¼Œè¡¨ç¤ºå®ƒå¯¹å‘é€è¿‡çš„eventçš„ç¼“å­˜ä¸ªæ•°</li><li>å®ƒä¼šç¼“å­˜bufferSizeä¸ª .next äº‹ä»¶ï¼Œæ–°çš„è®¢é˜…è€…ä¼šç«‹åˆ»æ”¶åˆ°ç¼“å­˜çš„ .nextäº‹ä»¶</li><li>å¦‚æœæ˜¯åœ¨subject ç»“æŸåè®¢é˜…çš„ï¼Œåˆ™é™¤äº†ç¼“å­˜çš„ .nextäº‹ä»¶ è¿˜ä¼šæ”¶åˆ° .complete or .error</li></ul><ol start="4"><li><strong>Variable</strong></li></ol><ul><li>æ˜¯å¯¹ BehaviorSubject çš„ä¸€å±‚å°è£…ï¼Œå¿…é¡»é€šè¿‡ä¸€ä¸ªåˆå§‹å€¼æ¥åˆ›å»º</li><li>å…·æœ‰ BehaviorSubject ç›¸åŒçš„åŠŸèƒ½ï¼Œèƒ½å‘æ–°çš„è®¢é˜…è€…å‘é€ä¸Šä¸€ä¸ªevent è¿˜æœ‰ä¹‹åæ–°çš„event</li><li>ä¸åŒçš„æ˜¯ï¼Œ BehaviorSubjectä¼šå§å€¼ä½œä¸ºè‡ªå·±çš„å±æ€§ä¿å­˜ä¸‹æ¥ï¼Œåœ¨é”€æ¯æ—¶ä¼šè‡ªåŠ¨å‘é€ .completeã€‚</li><li>ä¸éœ€è¦ä¹Ÿä¸èƒ½ç»™å®ƒå‘é€ .complete or .error æ¥ç»“æŸå®ƒ</li></ul><ol start="5"><li><strong>BehaviorRelay</strong></li></ol><ul><li>æ˜¯å¯¹ BehaviorSubject çš„ä¸€å±‚åŒ…è£…</li><li>å’Œ BehaviorSubject ä¸åŒçš„æ˜¯ä¸èƒ½ç”¨ .error or .complete æ¥ç»“æŸ</li></ul><h4 id="6-drive"><a href="#6-drive" class="headerlink" title="6. drive"></a>6. <strong>drive</strong></h4><p>å¦‚æœæˆ‘ä»¬çš„åºåˆ—æ»¡è¶³å¦‚ä¸‹ç‰¹å¾ï¼Œå°±å¯ä»¥ä½¿ç”¨å®ƒï¼š</p><ul><li>ä¸ä¼šäº§ç”Ÿ error äº‹ä»¶</li><li>ä¸€å®šåœ¨ä¸»çº¿ç¨‹ç›‘å¬ï¼ˆMainSchedulerï¼‰</li><li>å…±äº«çŠ¶æ€å˜åŒ–ï¼ˆshareReplayLatestWhileConnectedï¼‰</li></ul><h4 id="7-flatMap"><a href="#7-flatMap" class="headerlink" title="7. flatMap"></a>7. <strong>flatMap</strong></h4><ul><li>flatMap ä¼šå¯¹æ¯ä¸€ä¸ªå…ƒç´ åº”ç”¨ä¸€ä¸ªè½¬æ¢æ–¹æ³•ï¼Œè½¬æ¢æˆä¸€ä¸ª Observableï¼Œç­‰äºæ˜¯å˜æˆä¸€ä¸ªObservablesçš„åºåˆ—ï¼Œç„¶åå†å¯¹Observablesçš„å…ƒç´ åˆå¹¶ä¹‹åå†å‘å‡ºæ¥ï¼Œç­‰äºåˆå°†å…¶é™ç»´æˆä¸€ä¸ªObservable</li><li>è¿™ä¸ªç”¨å¤„å¾ˆå¤§ï¼Œå¦‚æœä¸€ä¸ªObservable çš„å…ƒç´ åŒæ ·ä¹Ÿæ˜¯ä¸€ä¸ªObservableæ—¶ï¼Œåˆ©ç”¨flatMapå¯ä»¥å°†å…¶å…ƒç´ éƒ½å‘é€å‡ºæ¥ã€‚<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">let</span> subject1 <span class="hljs-operator">=</span> <span class="hljs-type">BehaviorSubject</span>(value: <span class="hljs-string">&quot;A&quot;</span>)<br><span class="hljs-keyword">let</span> subject2 <span class="hljs-operator">=</span> <span class="hljs-type">BehaviorSubject</span>(value: <span class="hljs-string">&quot;1&quot;</span>)<br> <br><span class="hljs-keyword">let</span> variable <span class="hljs-operator">=</span> <span class="hljs-type">Variable</span>(subject1)<br> <br>variable.asObservable()<br>    .flatMap &#123; <span class="hljs-variable">$0</span> &#125;<br>    .subscribe(onNext: &#123; <span class="hljs-built_in">print</span>(<span class="hljs-variable">$0</span>) &#125;)<br> <br>subject1.onNext(<span class="hljs-string">&quot;B&quot;</span>)<br>variable.value <span class="hljs-operator">=</span> subject2<br>subject2.onNext(<span class="hljs-string">&quot;2&quot;</span>)<br>subject1.onNext(<span class="hljs-string">&quot;C&quot;</span>)<br></code></pre></td></tr></table></figure></li></ul><h4 id="8-ControlProperty"><a href="#8-ControlProperty" class="headerlink" title="8. ControlProperty"></a>8. <strong>ControlProperty</strong></h4><p>ControlProperty æ˜¯ä¸“é—¨ç”¨æ¥æè¿°UIæ§ä»¶å±æ€§ï¼Œæ‹¥æœ‰è¯¥ç±»å‹çš„å±æ€§éƒ½æ˜¯è¢«è§‚å¯Ÿè€…Observable<br>æœ‰ä¸€ä¸‹ç‰¹å¾ï¼š</p><ul><li>ä¸ä¼šäº§ç”Ÿerror äº‹ä»¶</li><li>ä¸€å®šåœ¨ MainScheduler è®¢é˜…</li><li>ä¸€å®šåœ¨ MainScheduler ç›‘å¬</li></ul><h4 id="9-ControlEvent"><a href="#9-ControlEvent" class="headerlink" title="9. ControlEvent"></a>9. <strong>ControlEvent</strong></h4><p>ControlEvent æ˜¯ä¸“é—¨ç”¨æ¥æè¿°UIæ‰€äº§ç”Ÿçš„äº‹ä»¶ï¼Œæ‹¥æœ‰è¯¥ç±»å‹çš„å±æ€§éƒ½æ˜¯è¢«è§‚å¯Ÿè€…Observableæœ‰ä¸€ä¸‹ç‰¹å¾ï¼š</p><ul><li>ä¸ä¼šäº§ç”Ÿerror äº‹ä»¶</li><li>ä¸€å®šåœ¨ MainScheduler è®¢é˜…</li><li>ä¸€å®šåœ¨ MainScheduler ç›‘å¬</li><li>å…±äº«çŠ¶æ€å˜åŒ–</li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>WkWebviewä¸å…¶ä»–ç»„ä»¶æ··æ’</title>
    <link href="/2018/09/13/wkwebview/"/>
    <url>/2018/09/13/wkwebview/</url>
    
    <content type="html"><![CDATA[<p>æ ¹æ®é¡¹ç›®éœ€æ±‚ï¼Œéœ€è¦å¤šä¸ªwebviewå’Œè‡ªå®šä¹‰çš„ç»„ä»¶æ ¹æ® API è¿”å›æ•°æ®åŠ¨æ€æ··æ’ã€‚<br>å¹¶ä¸”éœ€è¦é’ˆå¯¹cssä»¥åŠå›¾ç‰‡æ‡’åŠ è½½ä¼˜åŒ–ã€‚</p><h3 id="ä¸€ã€æ·»åŠ css"><a href="#ä¸€ã€æ·»åŠ css" class="headerlink" title="ä¸€ã€æ·»åŠ css"></a>ä¸€ã€æ·»åŠ css</h3><p>è¿™ä¸€ç‚¹æ¯”è¾ƒç®€å•ï¼Œwebviewæ‰€æ˜¾ç¤ºçš„å†…å®¹æ˜¯é€šè¿‡æ¥å£è¿”å›è·å¾—çš„å­—ç¬¦ä¸²ã€‚<br>åšä¸€ä¸ªç®€å•çš„æ‹¼æ¥å°±å¯ä»¥ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">let</span> link <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&lt;link rel=<span class="hljs-subst">\&quot;</span>stylesheet<span class="hljs-subst">\&quot;</span> href=<span class="hljs-subst">\&quot;</span><span class="hljs-subst">\(String(describing: Bundle.main.url(forResource: <span class="hljs-string">&quot;RichStyle&quot;</span>, withExtension: <span class="hljs-string">&quot;css&quot;</span>)<span class="hljs-operator">!</span>))</span><span class="hljs-subst">\&quot;</span>&gt;&quot;</span><br><span class="hljs-keyword">let</span> htmlContent <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">&lt;header&gt;</span><br><span class="hljs-string">&lt;meta name=&#x27;viewport&#x27; content=&#x27;width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no&#x27; /&gt;</span><br><span class="hljs-string"><span class="hljs-subst">\(link)</span></span><br><span class="hljs-string">&lt;/header&gt;</span><br><span class="hljs-string">&lt;div class=&#x27;richtext-container&#x27;&gt;</span><br><span class="hljs-string"><span class="hljs-subst">\(newContent)</span></span><br><span class="hljs-string">&lt;/div&gt;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><strong>newContent</strong> æ˜¯å†…å®¹æ­£æ–‡<br><strong>link</strong> æ˜¯cssæ ·å¼<br>å…¶ä¸­ç”±äºæ˜¾ç¤ºé—®é¢˜ï¼Œéœ€è¦åœ¨å¤´éƒ¨æ·»åŠ  <strong>meta</strong> è¿™ä¸€æ®µã€‚<br>ç”±äºcssæ¯”è¾ƒå¤šï¼Œæ”¾åœ¨ä¸€èµ·ä¸å¤ªåˆé€‚ã€‚å¯ä»¥å†™åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œé€šè¿‡ <strong>Bundle</strong> å½¢å¼åŠ è½½ã€‚<br>è¿™é‡Œæœ‰ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œcssæ–‡ä»¶å­˜æ”¾çš„ä½ç½®ã€‚<br>æ­¤åˆ»RichStyle.css å­˜æ”¾åœ¨/Classes/Utils/ ä¸‹ã€‚<br>è¦åœ¨åŠ è½½html æ—¶ï¼ŒæŒ‡å®šåœ¨ <strong>file:///Classes/Utils/</strong> ç›®å½•ä¸‹ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Swift">webView.loadHTMLString(htmlContent, baseURL: <span class="hljs-type">URL</span>(string: <span class="hljs-string">&quot;file:///Classes/Utils/&quot;</span>) )<br></code></pre></td></tr></table></figure><h3 id="äºŒã€å›¾ç‰‡æ‡’åŠ è½½"><a href="#äºŒã€å›¾ç‰‡æ‡’åŠ è½½" class="headerlink" title="äºŒã€å›¾ç‰‡æ‡’åŠ è½½"></a>äºŒã€å›¾ç‰‡æ‡’åŠ è½½</h3><p>å¦‚æœæ˜¯å•ä¸ªwebviewï¼Œä¸”è§†çª—å¤§å°å›ºå®šã€‚å¯ä»¥ä½¿ç”¨ <strong>lazysizes</strong>ï¼Œçº¯jsåŸç”Ÿï¼Œä¸ä¾èµ–ä»»ä½•å…¶ä»–åº“ã€‚<br><strong>lazysizes</strong> çš„é€»è¾‘æ˜¯webview è§†çª—ä¹‹å¤–çš„å›¾ç‰‡æ‡’åŠ è½½ï¼Œæ»‘åŠ¨åˆ°è§†çª—çš„img æ‰ä¼šåŠ è½½ã€‚<br>ä½†é¡¹ç›®ä¸­æ˜¯å¤šä¸ªwebview åŠå…¶ä»–ç»„ä»¶ å…¨å±•å¼€æ˜¾ç¤ºåœ¨scrollviewé‡Œé¢ã€‚<br>webview è§†çª—é«˜åº¦æ ¹æ®å†…å®¹é«˜åº¦æ¥çš„ã€‚å¯¼è‡´ <strong>lazysizes</strong>ä¾æ—§è¿˜æ˜¯åœ¨åŠ è½½åŒæ—¶æŠŠæ‰€æœ‰é¡µé¢å›¾ç‰‡åŠ è½½å®Œï¼Œä¸è¿‡åŠ è½½å›¾ç‰‡æ˜¯åœ¨ <strong>didFinish</strong>ä¹‹åã€‚</p><p>ç›®å‰çš„è§£å†³åŠæ³•å°±æ˜¯ï¼š</p><ul><li>æ‹¿åˆ°æ•°æ®åå¯¹å…¶ä¸­imgæ ‡ç­¾ä½œè°ƒæ•´ï¼Œå°†src çš„å€¼æ›¿æ¢åˆ° data-srcä¸­ï¼Œè¿™æ ·æ²¡æœ‰src åˆ™å›¾ç‰‡ä¸ä¼šåŠ è½½ã€‚æˆ–è€…ç»™srcè®¾ç½®ä¸€ä¸ªå ä½å›¾ç‰‡çš„å€¼ä¹Ÿå¯ä»¥ï¼Œå¹¶è®¾ç½®å¥½å¤§å°ã€‚</li><li>åœ¨scrollview ä¸­é’ˆå¯¹æ»šåŠ¨ä»£ç†æ–¹æ³•ä¼˜åŒ–ï¼Œè®©é¡µé¢åœæ­¢ä¸‹æ¥æ—¶æ‰å¼€å§‹è§¦å‘åŠ è½½å›¾ç‰‡çš„æ–¹æ³•ã€‚</li><li>è§¦å‘çš„æ–¹æ³• ä¼šè®©scrollviewä¸­ æ‰€æœ‰çš„webview è°ƒç”¨ åˆ¤æ–­æ˜¯å¦åŠ è½½å›¾ç‰‡çš„jsè„šæœ¬ã€‚å¹¶ä¸”ä¼šä¼ å…¥å½“å‰scrollviewçš„contentOffset å’Œ webviewçš„frame.minY</li><li>jsè„šæœ¬æ‹¿åˆ°å½“å‰webview å½“ä¸­æ‰€æœ‰çš„imgsï¼Œéå†æ¯ä¸€ä¸ªimgï¼Œå¹¶æ ¹æ®imgçš„topoff å’Œwebview çš„åç§»å‚æ•°è®¡ç®—è¿™ä¸ªimg æ˜¯å¦æ˜¯åœ¨scrollviewçš„è§†çª—å†…ã€‚</li><li>ç„¶ååˆ¤æ–­ä¿®æ”¹imgçš„src åŠ è½½å›¾ç‰‡ã€‚</li><li>è¿˜æœ‰ç‚¹å°±æ˜¯è¦åˆ·æ–°webviewçš„é«˜åº¦, å¯ä»¥åœ¨åŠ è½½å›¾ç‰‡å js è°ƒswift åˆ·æ–°é«˜åº¦ï¼Œæˆ–è€…å¼„ä¸ªå®šæ—¶å™¨æ‰§è¡Œjsè„šæœ¬åˆ·æ–°é«˜åº¦</li></ul><h5 id="ä¸€ã€åœæ­¢æ»šåŠ¨è§¦å‘ç›‘æµ‹åŠ è½½å›¾ç‰‡çš„æ–¹æ³•"><a href="#ä¸€ã€åœæ­¢æ»šåŠ¨è§¦å‘ç›‘æµ‹åŠ è½½å›¾ç‰‡çš„æ–¹æ³•" class="headerlink" title="ä¸€ã€åœæ­¢æ»šåŠ¨è§¦å‘ç›‘æµ‹åŠ è½½å›¾ç‰‡çš„æ–¹æ³•"></a>ä¸€ã€åœæ­¢æ»šåŠ¨è§¦å‘ç›‘æµ‹åŠ è½½å›¾ç‰‡çš„æ–¹æ³•</h5><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">scrollViewDidEndDragging</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">scrollView</span>: <span class="hljs-type">UIScrollView</span>, <span class="hljs-params">willDecelerate</span> <span class="hljs-params">decelerate</span>: <span class="hljs-type">Bool</span>)</span> &#123;<br>    <span class="hljs-keyword">if</span> <span class="hljs-operator">!</span>decelerate &#123;<br>        <span class="hljs-keyword">let</span> dragTpDragStop <span class="hljs-operator">=</span> scrollView.isTracking <span class="hljs-operator">&amp;&amp;</span> <span class="hljs-operator">!</span>scrollView.isDragging <span class="hljs-operator">&amp;&amp;</span> <span class="hljs-operator">!</span>scrollView.isDecelerating<br>        <span class="hljs-keyword">if</span> dragTpDragStop &#123;<br>            scrollViewDidEndScroll()<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">scrollViewDidEndDecelerating</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">scrollView</span>: <span class="hljs-type">UIScrollView</span>)</span> &#123;<br>    <span class="hljs-keyword">let</span> scrollToScrollStop <span class="hljs-operator">=</span> <span class="hljs-operator">!</span>scrollView.isTracking <span class="hljs-operator">&amp;&amp;</span> <span class="hljs-operator">!</span>scrollView.isDragging <span class="hljs-operator">&amp;&amp;</span> <span class="hljs-operator">!</span>scrollView.isDecelerating<br>    <span class="hljs-keyword">if</span> scrollToScrollStop &#123;<br>        scrollViewDidEndScroll()<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">scrollViewDidEndScroll</span>()</span> &#123;<br>    <span class="hljs-keyword">let</span> scrollOffset <span class="hljs-operator">=</span> scrollView.contentOffset.y<br>    <span class="hljs-keyword">for</span> rh <span class="hljs-keyword">in</span> allRichText.enumerated() &#123;<span class="hljs-comment">// rh æ˜¯ä¸€ä¸ªåŒ…å« webviewå±æ€§çš„ç»„ä»¶</span><br>        rh.element.loadImgsScript(offset:scrollOffset, wkTop: rh.element.frame.minY)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="äºŒã€æ‰§è¡Œæ¯ä¸ªwebviewçš„JSè„šæœ¬"><a href="#äºŒã€æ‰§è¡Œæ¯ä¸ªwebviewçš„JSè„šæœ¬" class="headerlink" title="äºŒã€æ‰§è¡Œæ¯ä¸ªwebviewçš„JSè„šæœ¬"></a>äºŒã€æ‰§è¡Œæ¯ä¸ªwebviewçš„JSè„šæœ¬</h5><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">loadImgsScript</span>(<span class="hljs-params">offset</span>: <span class="hljs-type">CGFloat</span>, <span class="hljs-params">wkTop</span>: <span class="hljs-type">CGFloat</span>)</span> &#123;<br>    <span class="hljs-keyword">let</span> minOffset <span class="hljs-operator">=</span> offset<br>    <span class="hljs-keyword">let</span> maxOffset <span class="hljs-operator">=</span> offset <span class="hljs-operator">+</span> bmy_screenHeight<br>    <span class="hljs-keyword">let</span> script <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        var imgs = document.getElementsByTagName(&#x27;img&#x27;);</span><br><span class="hljs-string">        var minOffset = <span class="hljs-subst">\(minOffset)</span></span><br><span class="hljs-string">        var maxOffset = <span class="hljs-subst">\(maxOffset)</span></span><br><span class="hljs-string">        var wkTop = <span class="hljs-subst">\(wkTop)</span></span><br><span class="hljs-string">        function lazyload()&#123;</span><br><span class="hljs-string">            for(var i=0; i&lt;imgs.length; i++) &#123;</span><br><span class="hljs-string">                var img = imgs[i]</span><br><span class="hljs-string">                var top = img.offsetTop + wkTop</span><br><span class="hljs-string">                var isDisplay = false</span><br><span class="hljs-string">                if((top &gt; minOffset - 300) &amp;&amp; top &lt; maxOffset + 300) &#123;</span><br><span class="hljs-string">                    isDisplay = true</span><br><span class="hljs-string">                &#125;</span><br><span class="hljs-string">                if(isDisplay)&#123;</span><br><span class="hljs-string">                    img.src = img.getAttribute(&#x27;data-src&#x27;);</span><br><span class="hljs-string">                    img.setAttribute(&#x27;class&#x27;,&#x27;lazyloaded&#x27;);</span><br><span class="hljs-string">                &#125;</span><br><span class="hljs-string">            &#125;</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">        lazyload()</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    webView.evaluateJavaScript(script) &#123; (res, error) <span class="hljs-keyword">in</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> e <span class="hljs-operator">=</span> error &#123;<br>            <span class="hljs-built_in">print</span>(error)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åˆ·æ–°webview-çš„é«˜åº¦"><a href="#åˆ·æ–°webview-çš„é«˜åº¦" class="headerlink" title="åˆ·æ–°webview çš„é«˜åº¦"></a>åˆ·æ–°webview çš„é«˜åº¦</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">@objc</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">reloadWebviewHeight</span>()</span> &#123;<br>    webView.evaluateJavaScript(<span class="hljs-string">&quot;document.body.scrollHeight&quot;</span>) &#123; (value, error) <span class="hljs-keyword">in</span><br>        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> safeValue <span class="hljs-operator">=</span> value <span class="hljs-keyword">else</span> &#123; <span class="hljs-keyword">return</span> &#125;<br>        <span class="hljs-keyword">let</span> height <span class="hljs-operator">=</span> <span class="hljs-type">CGFloat</span>(safeValue <span class="hljs-keyword">as!</span> <span class="hljs-type">CGFloat</span>)<br><br>        <span class="hljs-keyword">if</span> height <span class="hljs-operator">&gt;</span> <span class="hljs-keyword">self</span>.contentHeight &#123;<br>            <span class="hljs-keyword">self</span>.contentHeight <span class="hljs-operator">=</span> height<br>            <span class="hljs-keyword">self</span>.webView.snp.updateConstraints(&#123; (make) <span class="hljs-keyword">in</span><br>                make.height.equalTo(height)<br>            &#125;)<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>WkWebview ä¸ js äº¤äº’</title>
    <link href="/2018/09/13/wkwebview-js/"/>
    <url>/2018/09/13/wkwebview-js/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘ç”±äºé¡¹ç›®çš„åŸå› ï¼Œéœ€è¦wkwebview ä¸ js é¢‘ç¹çš„äº¤äº’<br>ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§</p><ul><li>Content-Blocking Rules</li><li>è°ƒç”¨wkwebview çš„jsæ‰§è¡Œè„šæœ¬çš„æ–¹æ³•</li><li>JS è°ƒç”¨ swift</li></ul><h3 id="ä¸€ã€Content-Blocking-Rules"><a href="#ä¸€ã€Content-Blocking-Rules" class="headerlink" title="ä¸€ã€Content-Blocking Rules"></a>ä¸€ã€Content-Blocking Rules</h3><p>å¦‚æœæ˜¯iOS11 ä¹‹åçš„å¹¶ä¸”éœ€æ±‚ç®€å• wkwebview æä¾›äº†ä¸€ä¸ªå†…å®¹è¿‡æ»¤è§„åˆ™çš„åŠŸèƒ½ã€‚å¯ä»¥ç®€å•å¤„ç†ä¸€äº›æ“ä½œã€‚è¿™ä¸ªçš„å¥½å¤„æ˜¯webviewæ˜¾ç¤ºå†…å®¹ä¹‹å‰å°±å¯ä»¥å¤„ç†ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">let</span> jsonString <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">[&#123;</span><br><span class="hljs-string">    &quot;trigger&quot;:&#123;</span><br><span class="hljs-string">        &quot;url-filter&quot;: &quot;.*&quot;,</span><br><span class="hljs-string">        &quot;resource-type&quot;:[&quot;document&quot;]</span><br><span class="hljs-string">    &#125;,</span><br><span class="hljs-string">    &quot;action&quot;:&#123;</span><br><span class="hljs-string">        &quot;type&quot;: &quot;css-display-none&quot;,</span><br><span class="hljs-string">        &quot;selector&quot;: &quot;.js-mp-info&quot;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">#available</span>(<span class="hljs-keyword">iOS</span> <span class="hljs-number">11.0</span>, <span class="hljs-operator">*</span>) &#123;<br>    <span class="hljs-type">WKContentRuleListStore</span>.default().compileContentRuleList(forIdentifier: <span class="hljs-string">&quot;demoRuleList&quot;</span>, encodedContentRuleList: jsonString) &#123; (list, error) <span class="hljs-keyword">in</span><br>        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> contentRuleList <span class="hljs-operator">=</span> list <span class="hljs-keyword">else</span> &#123; <span class="hljs-keyword">return</span> &#125;<br>        <span class="hljs-keyword">let</span> configuration <span class="hljs-operator">=</span> <span class="hljs-keyword">self</span>.webView.configuration<br>        configuration.userContentController.add(contentRuleList)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> detailUrl <span class="hljs-operator">=</span> <span class="hljs-keyword">self</span>.detailUrl &#123;<br>            <span class="hljs-keyword">self</span>.urlStr <span class="hljs-operator">=</span> detailUrl<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>url-filter å¯ä»¥ç”¨æ­£åˆ™åŒ¹é…url æ˜¯å¦è§¦å‘è§„åˆ™è¿‡æ»¤<br>resource-type æ˜¯é€‚ç”¨èµ„æºç±»å‹</p><ul><li>document</li><li>image</li><li>style-sheet</li><li>script</li><li>font</li><li>raw (Any untyped load, such as XMLHttpRequest)</li><li>svg-document</li><li>media</li><li>popup</li></ul><p>action type æ˜¯åŠ¨ä½œç±»å‹</p><ul><li><p>block<br>Tells the browser engine to abort loading the resource. If the resource was cached, the cache is ignored.</p></li><li><p>block-cookies<br>The engine strips all cookies from the header before sending the request to the server. Safariâ€™s own privacy policy takes precedence, so that only cookies that would otherwise be accepted by the privacy policy can be blocked. Combining block-cookies and ignore-previous-rules will not override the browserâ€™s privacy settings.</p></li><li><p>css-display-none<br>Hides elements of the page based on a CSS selector. A second action field, named selector, contains the selector list. Any element matching the selector list has its display property set to none, which hides it.</p></li><li><p>ignore-previous-rules<br>Previously triggered actions are not performed.</p></li><li><p>make-https<br>Changes a URL from http to https before making a server request. URLs with a specified port (other than the default port 80) and links using other protocols are not affected.</p></li></ul><p><a href="https://developer.apple.com/library/archive/documentation/Extensions/Conceptual/ContentBlockingRules/CreatingRules/CreatingRules.html"><strong>Content-Blocking Rules</strong> Appleå®˜æ–¹æ–‡æ¡£ä½¿ç”¨è¯´æ˜</a></p><h3 id="äºŒã€è°ƒç”¨wkwebview-çš„jsæ‰§è¡Œè„šæœ¬çš„æ–¹æ³•"><a href="#äºŒã€è°ƒç”¨wkwebview-çš„jsæ‰§è¡Œè„šæœ¬çš„æ–¹æ³•" class="headerlink" title="äºŒã€è°ƒç”¨wkwebview çš„jsæ‰§è¡Œè„šæœ¬çš„æ–¹æ³•"></a>äºŒã€è°ƒç”¨wkwebview çš„jsæ‰§è¡Œè„šæœ¬çš„æ–¹æ³•</h3><p>å¦‚æœç‰ˆæœ¬å°äºios11ï¼Œæ²¡æœ‰Content-Blocking Rulesï¼Œæˆ–è€…è§„åˆ™ä¸èƒ½æ»¡è¶³éœ€æ±‚ã€‚<br>ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ <strong>wk.evaluateJavaScript</strong> æ–¹æ³•, ç›´æ¥æ‰§è¡Œjsã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">let</span> str <span class="hljs-operator">=</span> <span class="hljs-string">&quot;$(&#x27;.js-mp-info&#x27;).remove();&quot;</span><br>webView.evaluateJavaScript(str, completionHandler: <span class="hljs-literal">nil</span>)<br></code></pre></td></tr></table></figure><p>JSä»£ç é™¤äº†ç›´æ¥å†™æˆstringä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥åœ¨å¦å†™åœ¨æ–‡ä»¶é‡Œï¼Œç„¶åè¯»å–æ–‡ä»¶ã€‚<br>ä¾‹å¦‚ JSç›¸å…³ä»£ç å†™åœ¨ <strong>LoginJavaScript.js</strong> æ–‡ä»¶é‡Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">var</span> jsHandler <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">do</span> &#123;<br>    jsHandler <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-type">String</span>(contentsOf: <span class="hljs-type">Bundle</span>.main.url(forResource: <span class="hljs-string">&quot;LoginJavaScript&quot;</span>, withExtension: <span class="hljs-string">&quot;js&quot;</span>)<span class="hljs-operator">!</span>, encoding: <span class="hljs-type">String</span>.<span class="hljs-type">Encoding</span>.utf8)<br>&#125; <span class="hljs-keyword">catch</span> &#123;&#125;<br><span class="hljs-keyword">let</span> wkScript <span class="hljs-operator">=</span> <span class="hljs-type">WKUserScript</span>.<span class="hljs-keyword">init</span>(source: jsHandler,<br>                                  injectionTime: <span class="hljs-type">WKUserScriptInjectionTime</span>.atDocumentEnd,<br>                                  forMainFrameOnly: <span class="hljs-literal">true</span>)<br>config.userContentController.addUserScript(wkScript)<br><span class="hljs-keyword">let</span> wk <span class="hljs-operator">=</span> <span class="hljs-type">WKWebView</span>.<span class="hljs-keyword">init</span>(frame: .zero, configuration: config)<br></code></pre></td></tr></table></figure><h3 id="ä¸‰ã€JS-è°ƒç”¨-swift"><a href="#ä¸‰ã€JS-è°ƒç”¨-swift" class="headerlink" title="ä¸‰ã€JS è°ƒç”¨ swift"></a>ä¸‰ã€JS è°ƒç”¨ swift</h3><h4 id="é¢„å®šä¹‰"><a href="#é¢„å®šä¹‰" class="headerlink" title="é¢„å®šä¹‰"></a>é¢„å®šä¹‰</h4><p>wkwebviewçš„ config å¯ä»¥äº‹å…ˆå®šä¹‰ä¸€äº›äº‹ä»¶</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">let</span> config <span class="hljs-operator">=</span> <span class="hljs-type">WKWebViewConfiguration</span>()<br>config.userContentController.add(<span class="hljs-keyword">self</span>, name: <span class="hljs-string">&quot;eventOne&quot;</span>)<br>config.userContentController.add(<span class="hljs-keyword">self</span>, name: <span class="hljs-string">&quot;eventTwo&quot;</span>)<br></code></pre></td></tr></table></figure><h4 id="JSè°ƒç”¨"><a href="#JSè°ƒç”¨" class="headerlink" title="JSè°ƒç”¨"></a>JSè°ƒç”¨</h4><p>ç„¶ååœ¨JS è„šæœ¬é‡Œé¢è°ƒç”¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript">webkit.messageHandlers.eventOne.postMessage(message);<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ <strong>eventOne</strong> å°±æ˜¯ä¹‹å‰äº‹å…ˆå®šä¹‰å¥½çš„äº‹ä»¶åå­—ã€‚<br><strong>message</strong> å°±æ˜¯ js å‘ swift ä¼ é€’çš„ä¿¡æ¯</p><h4 id="Swift-ä»£ç†æ–¹æ³•ç›‘å¬"><a href="#Swift-ä»£ç†æ–¹æ³•ç›‘å¬" class="headerlink" title="Swift ä»£ç†æ–¹æ³•ç›‘å¬"></a>Swift ä»£ç†æ–¹æ³•ç›‘å¬</h4><p>å®ç° <strong>WKScriptMessageHandler</strong> ä¸‹çš„ä¸€ä¸ªä»£ç†æ–¹æ³•ï¼Œåœ¨æ–¹æ³•é‡Œé¢ç›‘æµ‹åˆ°JSè§¦å‘çš„é¢„å®šä¹‰çš„äº‹ä»¶</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">userContentController</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">userContentController</span>: <span class="hljs-type">WKUserContentController</span>, <span class="hljs-params">didReceive</span> <span class="hljs-params">message</span>: <span class="hljs-type">WKScriptMessage</span>)</span> &#123;<br>  <span class="hljs-keyword">switch</span> message.name &#123;<br>  <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;eventOne&quot;</span>:<br>      <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;eventOne&quot;</span>)<br>      <span class="hljs-built_in">print</span>(message.body)<span class="hljs-comment">//jsä¼ æ¥çš„ä¿¡æ¯</span><br>  <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;eventTwo&quot;</span>:<br>      <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;eventTwo&quot;</span>)<br>  <span class="hljs-keyword">default</span>:<br>      <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;none&quot;</span>)<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>iOSçº¦æŸå†²çªè­¦å‘Šè§£å†³åŠæ³•</title>
    <link href="/2018/09/12/ios-constraints/"/>
    <url>/2018/09/12/ios-constraints/</url>
    
    <content type="html"><![CDATA[<p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸ä¼šé‡åˆ°é¡µé¢æ˜¾ç¤ºæ­£å¸¸ï¼Œä½†ä¾ç„¶è¿˜æœ‰å†²çªè­¦å‘Šã€‚<br>é€šå¸¸çš„åŸå› æœ‰2ä¸ªã€‚</p><h3 id="ä¸€ã€cell-ä¸­çš„çº¦æŸå†²çª"><a href="#ä¸€ã€cell-ä¸­çš„çº¦æŸå†²çª" class="headerlink" title="ä¸€ã€cell ä¸­çš„çº¦æŸå†²çª"></a>ä¸€ã€cell ä¸­çš„çº¦æŸå†²çª</h3><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨ xcode çš„æ§åˆ¶å°æ‰“å°å‡ºå¾—ä¿¡æ¯å½“ä¸­ä¼šå•ç‹¬æ‹å‡ºä¸€æ¡çº¦æŸã€‚<br>Will attempt to recover by breaking constraint ä¸‹é¢é‚£ä¸€æ¡</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-type">Probably</span> at least one of the constraints <span class="hljs-keyword">in</span> the following list <span class="hljs-keyword">is</span> one you don&#x27;t want. <br><span class="hljs-type">Try</span> this: <br>    (<span class="hljs-number">1</span>) look at each constraint and <span class="hljs-keyword">try</span> to figure out which you don&#x27;t expect; <br>    (<span class="hljs-number">2</span>) find the code that added the unwanted constraint or constraints and fix it. <br>(<br>    <span class="hljs-string">&quot;&lt;SnapKit.LayoutConstraint:0x6040002a08a0@ChoiceArticleCell.swift#182 UIImageView:0x7fae99d49240.left == UIView:0x7fae99d55e70.left&gt;&quot;</span>,<br>    <span class="hljs-string">&quot;&lt;SnapKit.LayoutConstraint:0x6040002a0900@ChoiceArticleCell.swift#182 UIImageView:0x7fae99d49240.top == UIView:0x7fae99d55e70.top&gt;&quot;</span>,<br>    <span class="hljs-string">&quot;&lt;SnapKit.LayoutConstraint:0x6040002a0960@ChoiceArticleCell.swift#182 UIImageView:0x7fae99d49240.right == UIView:0x7fae99d55e70.right&gt;&quot;</span>,<br>    <span class="hljs-string">&quot;&lt;SnapKit.LayoutConstraint:0x6040002a09c0@ChoiceArticleCell.swift#182 UIImageView:0x7fae99d49240.bottom == UIView:0x7fae99d55e70.bottom&gt;&quot;</span><br>)<br><br><span class="hljs-type">Will</span> attempt to recover by breaking constraint <br><span class="hljs-operator">&lt;</span><span class="hljs-type">SnapKit</span>.<span class="hljs-type">LayoutConstraint</span>:<span class="hljs-number">0x6040002a0a20</span><span class="hljs-meta">@ChoiceArticleCell</span>.swift#<span class="hljs-number">183</span> <span class="hljs-type">UIImageView</span>:<span class="hljs-number">0x7fae99d49240</span>.height <span class="hljs-operator">==</span> <span class="hljs-type">UIImageView</span>:<span class="hljs-number">0x7fae99d49240</span>.width <span class="hljs-operator">*</span> <span class="hljs-number">0.425531923770905</span><span class="hljs-operator">&gt;</span><br></code></pre></td></tr></table></figure><p>è§£å†³åŠæ³•å°±æ˜¯ï¼šå°†è¿™æ¡çº¦æŸçš„ <strong>ä¼˜å…ˆçº§é™ä½</strong>ã€‚çº¦æŸé»˜è®¤çš„ä¼˜å…ˆçº§æ˜¯1000ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Swift">make.height.equalTo(cover.snp.width).multipliedBy(<span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">2.35</span>).priority(<span class="hljs-number">999</span>)<br></code></pre></td></tr></table></figure><h3 id="äºŒã€æ™®é€šviewé‡Œé¢-ä¼šå‡ºç°-çº¦æŸå†²çª"><a href="#äºŒã€æ™®é€šviewé‡Œé¢-ä¼šå‡ºç°-çº¦æŸå†²çª" class="headerlink" title="äºŒã€æ™®é€šviewé‡Œé¢ ä¼šå‡ºç° çº¦æŸå†²çª"></a>äºŒã€æ™®é€šviewé‡Œé¢ ä¼šå‡ºç° çº¦æŸå†²çª</h3><p>è¿™ç§æƒ…å†µ é€šå¸¸æ˜¯viewçš„ <strong>translatesAutoresizingMaskIntoConstraints</strong>å±æ€§ å¯¼è‡´<br>å°†å…¶æ”¹ä¸º false å¯ä»¥è§£å†³é—®é¢˜<br>é’ˆå¯¹ view<br>å¦‚æœä½¿ç”¨ autulayout å°±å°† translatesAutoresizingMaskIntoConstraints è®¾ä¸º false<br>å¦‚æœä¸ä½¿ç”¨ autulayout å°±å°† translatesAutoresizingMaskIntoConstraints è®¾ä¸º true</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Swift"><span class="hljs-keyword">self</span>.translatesAutoresizingMaskIntoConstraints <span class="hljs-operator">=</span> <span class="hljs-literal">false</span><br><br></code></pre></td></tr></table></figure><p>åœ¨ tableview çš„ header or footerview ä½¿ç”¨çº¦æŸçš„ view<br>è¯¥ view çš„ translatesAutoresizingMaskIntoConstraints å±æ€§éœ€è¦è®¾ç½®ä¸º true</p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
